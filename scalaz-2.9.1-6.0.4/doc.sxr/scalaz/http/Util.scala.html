<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>scalaz/http/Util.scala</title>
        <script type="text/javascript" src="../../jquery-all.js"></script>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scalaz
<span class="keyword">package</span> http

<span class="keyword">import</span> collection.immutable.<span class="delimiter">{</span>Map, HashMap<span class="delimiter">}</span>
<span class="keyword">import</span> <a href="../Scalaz.scala.html#19508" title="object scalaz.Scalaz">Scalaz</a>._
<span class="keyword">import</span> java.net.<span title="object java.net.URLDecoder">URLDecoder</span>.decode
<span class="keyword">import</span> io.Codec

<span class="comment">/**
 * Utility functions not specific to any particular context within HTTP.
 *
 * @author &lt;a href=&quot;mailto:code@tmorris.net&quot;&gt;Tony Morris&lt;/a&gt;
 */</span>
<span class="keyword">object</span> <a title="object scalaz.http.Util" id="27223">Util</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="comment">/**
   * Splits the given argument by ampersand (&lt;code&gt;&amp;&lt;/code&gt;) then each list again by the equals sign (&lt;code&gt;=&lt;/code&gt;).
   * e.g. &lt;code&gt;parameters(&quot;a=b&amp;c=d&amp;e=f&quot;) == [(&quot;a&quot;, &quot;b&quot;), (&quot;c&quot;, &quot;d&quot;), (&quot;e&quot;, &quot;f&quot;)]&lt;/code&gt; 
   */</span>
  <span class="keyword">def</span> <a title="(p: List[Char])List[(List[Char], List[Char])]" id="834931">parameters</a><span class="delimiter">(</span><a title="List[Char]" id="865309">p</a>: <span title="List[Char]">List</span><span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="List[(List[Char], List[Char])]">List</span><span class="delimiter">[</span><span class="delimiter">(</span>List<span class="delimiter">[</span>Char<span class="delimiter">]</span>, List<span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="List[List[Char]]" id="865311">x</a> = <a href="../MAB.scala.html#40376" title="(l: List[Char])scalaz.MA[List,Char]">p</a>.<a href="../MA.scala.html#64636" title="(p: Char =&gt; Boolean)(implicit r: scalaz.Foldable[List])List[List[Char]]">selectSplit</a><a href="../Foldable.scala.html#149140" title="=&gt; scalaz.Foldable[List]" class="delimiter">(</a><a href="#865520" title="Char">_</a> <span title="(x: Char)Boolean">!=</span> <span title="Char(\'&amp;\')" class="char">'&amp;'</span><span class="delimiter">)</span>
    <span class="comment">// TODO Get !- back in scalaz and use that</span>
    <span class="comment">//    x map (_ !- (_ == '=') match {</span>
    <span class="comment">//      case (a, b) =&gt; {</span>
    <span class="comment">//        (a, decode(b.mkString).drop(1).toList)</span>
    <span class="comment">//      }</span>
    <span class="comment">//    })</span>

    <a href="#865311" title="List[List[Char]]">x</a> <span title="(f: List[Char] =&gt; (List[Char], List[Char]))(implicit bf: scala.collection.generic.CanBuildFrom[List[List[Char]],(List[Char], List[Char]),List[(List[Char], List[Char])]])List[(List[Char], List[Char])]">map</span> <span class="delimiter">(</span><a title="List[Char]" id="865574">chars</a> =&gt; <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="List[Char]" id="865575">pre</a> = <a href="#865574" title="List[Char]">chars</a> <span title="(p: Char =&gt; Boolean)List[Char]">takeWhile</span> <span class="delimiter">(</span><a href="#865583" title="Char">_</a> <span title="(x: Char)Boolean">!=</span> <span title="Char(\'=\')" class="char">'='</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="List[Char]" id="865576">post</a> = <a href="#865574" title="List[Char]">chars</a> <span title="(p: Char =&gt; Boolean)List[Char]">dropWhile</span> <span class="delimiter">(</span><a href="#865592" title="Char">_</a> <span title="(x: Char)Boolean">!=</span> <span title="Char(\'=\')" class="char">'='</span><span class="delimiter">)</span>
      <span title="(_1: List[Char], _2: List[Char])(List[Char], List[Char])" class="delimiter">(</span><a href="#865575" title="List[Char]">pre</a>, <span title="(x$1: java.lang.String, x$2: java.lang.String)java.lang.String">decode</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="delimiter">(</span><a href="#865576" title="List[Char]">post</a>.<span title="=&gt; String">mkString</span>, <span title="object scala.io.Codec">Codec</span>.<span title="=&gt; java.nio.charset.Charset">UTF8</span>.<span title="()java.lang.String">name</span><span class="delimiter">)</span>.<span title="(n: Int)String">drop</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<span title="=&gt; List[Char]">toList</span><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Encodes the given parameters by inserting an ampersand (&lt;code&gt;&amp;&lt;/code&gt;) between each pair and an equals sign
   * (&lt;code&gt;=&lt;/code&gt;) with each pair.
   */</span>
  <span class="keyword">def</span> <a title="(p: (List[Char], List[Char])*)String" id="834932">encodeParameters</a><span class="delimiter">(</span><a title="(List[Char], List[Char])*" id="865892">p</a>: <span title="(List[Char], List[Char])*" class="delimiter">(</span>List<span class="delimiter">[</span>Char<span class="delimiter">]</span>, List<span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">)</span>*<span class="delimiter">)</span>: <span title="String">String</span> =
    <a href="#865892" title="(List[Char], List[Char])*">p</a>.<span title="=&gt; List[(List[Char], List[Char])]">toList</span> <a href="../ListW.scala.html#40135" title="(as: List[List[Char]])scalaz.ListW[List[Char]]">map</a> <a href="#865919" title="List[Char]" class="delimiter">{</a><span class="keyword">case</span> <span title="List[Char]" class="delimiter">(</span><a title="List[Char]" id="865922">k</a>, <a title="List[Char]" id="865923">v</a><span class="delimiter">)</span> =&gt; <a href="#865922" title="List[Char]">k</a> <a href="#865924" title="(prefix: List[Char])List[Char]">:::</a> <span title="Char(\'=\')" class="char">'='</span> <a href="#865925" title="(x: Char)List[Char]">::</a> <a href="#865923" title="List[Char]">v</a><span class="delimiter">}</span> <a href="../ListW.scala.html#66332" title="(a: List[Char])List[List[Char]]">intersperse</a> <span title="(xs: Char*)List[Char]">List</span><span class="delimiter">(</span><span title="Char(\'&amp;\')" class="char">'&amp;'</span><span class="delimiter">)</span> <span title="(f: List[Char] =&gt; scala.collection.GenTraversableOnce[Char])(implicit bf: scala.collection.generic.CanBuildFrom[List[List[Char]],Char,List[Char]])List[Char]">flatMap</span> <span class="delimiter">(</span><a title="List[Char]" id="866045">x</a> =&gt; <a href="#866045" title="List[Char]">x</a><span class="delimiter">)</span> <span title="=&gt; String">mkString</span>

  <span class="comment">/**
   * Encodes the given parameters by inserting an ampersand (&lt;code&gt;&amp;&lt;/code&gt;) between each pair and an equals sign
   * (&lt;code&gt;=&lt;/code&gt;) with each pair.
   */</span>
  <span class="keyword">def</span> <a title="(p: (String, String)*)String" id="834933">encode</a><span class="delimiter">(</span><a title="(String, String)*" id="864922">p</a>: <span title="(String, String)*" class="delimiter">(</span>String, String<span class="delimiter">)</span>*<span class="delimiter">)</span>: <span title="String">String</span> = <a href="#834932" title="(p: (List[Char], List[Char])*)String">encodeParameters</a><span class="delimiter">(</span><a href="#864922" title="(String, String)*">p</a> <span title="(f: (String, String) =&gt; (List[Char], List[Char]))(implicit bf: scala.collection.generic.CanBuildFrom[Seq[(String, String)],(List[Char], List[Char]),Seq[(List[Char], List[Char])]])Seq[(List[Char], List[Char])]">map</span> <a href="#866092" title="(List[Char], List[Char])" class="delimiter">{</a><span class="keyword">case</span> <span title="(List[Char], List[Char])" class="delimiter">(</span><a title="String" id="866095">k</a>, <a title="String" id="866096">v</a><span class="delimiter">)</span> =&gt; <span title="(_1: List[Char], _2: List[Char])(List[Char], List[Char])" class="delimiter">(</span><a href="#866095" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">k</a>.<span title="=&gt; List[Char]">toList</span>, <a href="#866096" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">v</a>.<span title="=&gt; List[Char]">toList</span><span class="delimiter">)</span><span class="delimiter">}</span>: _*<span class="delimiter">)</span>

  <span class="comment">/**
   * Returns a map of key/value pairs where only the first value for the given key is available.
   */</span>
  <span class="keyword">def</span> <a title="[K, C](p: scala.collection.immutable.Map[K,scalaz.NonEmptyList[C]])scala.collection.immutable.Map[K,C]" id="834934">mapHeads</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="834937">K</a>, <a title="&gt;: Nothing &lt;: Any" id="834938">C</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scala.collection.immutable.Map[K,scalaz.NonEmptyList[C]]" id="836713">p</a>: <span title="scala.collection.immutable.Map[K,scalaz.NonEmptyList[C]]">Map</span><span class="delimiter">[</span>K, NonEmptyList<span class="delimiter">[</span>C<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#836713" title="scala.collection.immutable.Map[K,scalaz.NonEmptyList[C]]">p</a>.<span title="(f: (K, scalaz.NonEmptyList[C]) =&gt; C)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Map[K,scalaz.NonEmptyList[C]],(K, C),scala.collection.immutable.Map[K,C]])scala.collection.immutable.Map[K,C]">transform</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.Map.Coll,(K, C),scala.collection.immutable.Map[K,C]]" class="delimiter">(</span><span class="delimiter">(</span><a title="K" id="836724">h</a>, <a title="scalaz.NonEmptyList[C]" id="836725">v</a><a href="../NonEmptyList.scala.html#18553" title="scalaz.NonEmptyList[C]" class="delimiter">)</a> =&gt; <a href="#836725" title="scalaz.NonEmptyList[C]">v</a>.<a href="../NonEmptyList.scala.html#48394" title="=&gt; C">head</a><span class="delimiter">)</span>

  <span class="keyword">trait</span> <a title="trait AsHashMap[T[_], SM[_]] extends java.lang.Object" id="834939">AsHashMap</a><span class="delimiter">[</span><a title="[_]&gt;: Nothing &lt;: Any" id="834940">T</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="866468">_</a><span class="delimiter">]</span>, <a title="[_]&gt;: Nothing &lt;: Any" id="834941">SM</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="837491">_</a><span class="delimiter">]</span><span class="delimiter">]</span> <span title="java.lang.Object" class="delimiter">{</span>
    <span class="keyword">def</span> <a title="[K, V](kvs: T[(K, V)])(implicit f: scalaz.Foldable[T], implicit s: scalaz.Semigroup[SM[V]], implicit md: scalaz.Monad[SM])scala.collection.immutable.Map[K,SM[V]]" id="837471">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="837474">K</a>, <a title="&gt;: Nothing &lt;: Any" id="837475">V</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="T[(K, V)]" id="837487">kvs</a>: <a href="#834940" title="T[(K, V)]">T</a><span class="delimiter">[</span><span class="delimiter">(</span>K, V<span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.Foldable[T]" id="837488">f</a>: <a href="../Foldable.scala.html#14560" title="scalaz.Foldable[T]">Foldable</a><span class="delimiter">[</span>T<span class="delimiter">]</span>, <a title="scalaz.Semigroup[SM[V]]" id="837489">s</a>: <a href="../Semigroup.scala.html#19849" title="scalaz.Semigroup[SM[V]]">Semigroup</a><span class="delimiter">[</span>SM<span class="delimiter">[</span>V<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="scalaz.Monad[SM]" id="837490">md</a>: <a href="../Monad.scala.html#18181" title="scalaz.Monad[SM]">Monad</a><span class="delimiter">[</span>SM<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="scala.collection.immutable.Map[K,SM[V]]">Map</span><span class="delimiter">[</span>K, SM<span class="delimiter">[</span>V<span class="delimiter">]</span><span class="delimiter">]</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Indexes the given sequence of key/value pairs using an empty hash-map. The key/value pair type constructor must
   * support fold-left and the index is created in constant space.
   */</span>
  <span class="keyword">def</span> <a title="[T[_], SM[_]]=&gt; java.lang.Object with scalaz.http.Util.AsHashMap[T,SM]" id="834942">asHashMap</a><span class="delimiter">[</span><a title="[_]&gt;: Nothing &lt;: Any" id="834945">T</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="837469">_</a><span class="delimiter">]</span>, <a title="[_]&gt;: Nothing &lt;: Any" id="834946">SM</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="837470">_</a><span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#837468" title="java.lang.Object with scalaz.http.Util.AsHashMap[T,SM]" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scalaz.http.Util.AsHashMap[T,SM]" id="837468">AsHashMap</a><span class="delimiter">[</span>T, SM<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="[K, V](kvs: T[(K, V)])(implicit f: scalaz.Foldable[T], implicit s: scalaz.Semigroup[SM[V]], implicit md: scalaz.Monad[SM])scala.collection.immutable.Map[K,SM[V]]" id="837477">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="837480">K</a>, <a title="&gt;: Nothing &lt;: Any" id="837481">V</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="T[(K, V)]" id="837482">kvs</a>: <a href="#834945" title="T[(K, V)]">T</a><span class="delimiter">[</span><span class="delimiter">(</span>K, V<span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.Foldable[T]" id="837483">f</a>: <a href="../Foldable.scala.html#14560" title="scalaz.Foldable[T]">Foldable</a><span class="delimiter">[</span>T<span class="delimiter">]</span>, <a title="scalaz.Semigroup[SM[V]]" id="837484">s</a>: <a href="../Semigroup.scala.html#19849" title="scalaz.Semigroup[SM[V]]">Semigroup</a><span class="delimiter">[</span>SM<span class="delimiter">[</span>V<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="scalaz.Monad[SM]" id="837485">md</a>: <a href="../Monad.scala.html#18181" title="scalaz.Monad[SM]">Monad</a><span class="delimiter">[</span>SM<span class="delimiter">]</span><span class="delimiter">)</span> =
      <a href="#834947" title="(e: scala.collection.immutable.Map[K,SM[V]], kvs: T[(K, V)])(implicit f: scalaz.Foldable[T], implicit s: scalaz.Semigroup[SM[V]], implicit md: scalaz.Monad[SM])scala.collection.immutable.Map[K,SM[V]]">asMap</a><a href="#837483" title="scalaz.Foldable[T]" class="delimiter">(</a><span title="scala.collection.immutable.HashMap[K,SM[V]]" class="keyword">new</span> <span title="scala.collection.immutable.HashMap[K,SM[V]]">HashMap</span><span class="delimiter">[</span>K, SM<span class="delimiter">[</span>V<span class="delimiter">]</span><span class="delimiter">]</span>, <a href="#837482" title="T[(K, V)]">kvs</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Indexes the given sequence of key/value pairs using the given map. The key/value pair type constructor must support
   * fold-left and the index is created in constant space.
   */</span>
  <span class="keyword">def</span> <a title="[T[_], SM[_], K, V](e: scala.collection.immutable.Map[K,SM[V]], kvs: T[(K, V)])(implicit f: scalaz.Foldable[T], implicit s: scalaz.Semigroup[SM[V]], implicit md: scalaz.Monad[SM])scala.collection.immutable.Map[K,SM[V]]" id="834947">asMap</a><span class="delimiter">[</span><a title="[_]&gt;: Nothing &lt;: Any" id="834952">T</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="837528">_</a><span class="delimiter">]</span>, <a title="[_]&gt;: Nothing &lt;: Any" id="834953">SM</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="837526">_</a><span class="delimiter">]</span>, <a title="&gt;: Nothing &lt;: Any" id="834954">K</a>, <a title="&gt;: Nothing &lt;: Any" id="834955">V</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scala.collection.immutable.Map[K,SM[V]]" id="837521">e</a>: <span title="scala.collection.immutable.Map[K,SM[V]]">Map</span><span class="delimiter">[</span>K, SM<span class="delimiter">[</span>V<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="T[(K, V)]" id="837522">kvs</a>: <a href="#834952" title="T[(K, V)]">T</a><span class="delimiter">[</span><span class="delimiter">(</span>K, V<span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">)</span>
                   <span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.Foldable[T]" id="837523">f</a>: <a href="../Foldable.scala.html#14560" title="scalaz.Foldable[T]">Foldable</a><span class="delimiter">[</span>T<span class="delimiter">]</span>, <a title="scalaz.Semigroup[SM[V]]" id="837524">s</a>: <a href="../Semigroup.scala.html#19849" title="scalaz.Semigroup[SM[V]]">Semigroup</a><span class="delimiter">[</span>SM<span class="delimiter">[</span>V<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="scalaz.Monad[SM]" id="837525">md</a>: <a href="../Monad.scala.html#18181" title="scalaz.Monad[SM]">Monad</a><span class="delimiter">[</span>SM<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="scala.collection.immutable.Map[K,SM[V]]">Map</span><span class="delimiter">[</span>K, SM<span class="delimiter">[</span>V<span class="delimiter">]</span><span class="delimiter">]</span> =
      <a href="#837523" title="scalaz.Foldable[T]">f</a>.<a href="../Foldable.scala.html#82740" title="[A, B](t: T[A], z: B, f: (B, A) =&gt; B)B">foldLeft</a><span title="(t: T[(K, V)], z: scala.collection.immutable.Map[K,SM[V]], f: (scala.collection.immutable.Map[K,SM[V]], (K, V)) =&gt; scala.collection.immutable.Map[K,SM[V]])scala.collection.immutable.Map[K,SM[V]]" class="delimiter">[</span><span title="(K, V)" class="delimiter">(</span>K, V<span class="delimiter">)</span>, <span title="scala.collection.immutable.Map[K,SM[V]]">Map</span><span class="delimiter">[</span>K, SM<span class="delimiter">[</span>V<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><a href="#837522" title="T[(K, V)]">kvs</a>, <a href="#837521" title="scala.collection.immutable.Map[K,SM[V]]">e</a>, <span class="delimiter">(</span><a title="scala.collection.immutable.Map[K,SM[V]]" id="866477">m</a>, <a title="(K, V)" id="866478">kv</a><span title="(K, V)" class="delimiter">)</span> =&gt; <a href="#866477" title="scala.collection.immutable.Map[K,SM[V]]">m</a> <span title="(kv: (K, SM[V]))scala.collection.immutable.Map[K,SM[V]]">+</span> <span class="delimiter">(</span><span title="(_1: K, _2: SM[V])(K, SM[V])" class="delimiter">(</span><a href="#866478" title="(K, V)">kv</a>.<span title="=&gt; K">_1</span>, <a href="#866477" title="scala.collection.immutable.Map[K,SM[V]]">m</a>.<span title="(key: K)Option[SM[V]]">get</span><span class="delimiter">(</span><a href="#866478" title="(K, V)">kv</a>.<span title="=&gt; K">_1</span><span class="delimiter">)</span> <span title="SM[V]" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="SM[V]">None</span> =&gt; <a href="#837525" title="scalaz.Monad[SM]">md</a>.<a href="../Pure.scala.html#39555" title="(a: =&gt; V)SM[V]">pure</a><span class="delimiter">(</span><a href="#866478" title="(K, V)">kv</a>.<span title="=&gt; V">_2</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="SM[V]">Some</span><span class="delimiter">(</span><a title="SM[V]" id="866545">vv</a><span class="delimiter">)</span> =&gt; <a href="#837524" title="scalaz.Semigroup[SM[V]]">s</a>.<a href="../Semigroup.scala.html#41943" title="(s1: SM[V], s2: =&gt; SM[V])SM[V]">append</a><span class="delimiter">(</span><a href="#837525" title="scalaz.Monad[SM]">md</a>.<a href="../Pure.scala.html#39555" title="(a: =&gt; V)SM[V]">pure</a><span class="delimiter">(</span><a href="#866478" title="(K, V)">kv</a>.<span title="=&gt; V">_2</span><span class="delimiter">)</span>, <a href="#866545" title="SM[V]">vv</a><span class="delimiter">)</span>
      <span class="delimiter">}</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">object</span> <a title="object scalaz.http.Util.Nel" id="834956">Nel</a> <span title="ScalaObject" class="delimiter">{</span>
    <span class="comment">/**
     * Creates a list from a potential non-empty list.
     */</span>
    <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[A](as: Option[scalaz.NonEmptyList[A]])List[A]" id="834961">OptionNonEmptyListList</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="834963">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Option[scalaz.NonEmptyList[A]]" id="836178">as</a>: <span title="Option[scalaz.NonEmptyList[A]]">Option</span><span class="delimiter">[</span>NonEmptyList<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>: <span title="List[A]">List</span><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#836178" title="Option[scalaz.NonEmptyList[A]]">as</a> <span title="List[A]" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="scala.collection.immutable.Nil.type">None</span> =&gt; <span title="object Nil">Nil</span>
      <span class="keyword">case</span> <span title="List[A]">Some</span><span class="delimiter">(</span><a title="scalaz.NonEmptyList[A]" id="866556">x</a><span class="delimiter">)</span> =&gt; <a href="#866556" title="scalaz.NonEmptyList[A]">x</a>.<a href="../NonEmptyList.scala.html#48394" title="=&gt; A">head</a> <a href="#866557" title="(x: A)List[A]">::</a> <a href="#866556" title="scalaz.NonEmptyList[A]">x</a>.<a href="../NonEmptyList.scala.html#48395" title="=&gt; List[A]">tail</a>
    <span class="delimiter">}</span>

    <span class="comment">/**
     * Creates a list from the given non-empty list.
     */</span>
    <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[A](xs: scalaz.NonEmptyList[A])List[A]" id="834964">NonEmptyListList</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="834966">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.NonEmptyList[A]" id="836175">xs</a>: <a href="../NonEmptyList.scala.html#18553" title="scalaz.NonEmptyList[A]">NonEmptyList</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="List[A]">List</span><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#836175" title="scalaz.NonEmptyList[A]">xs</a>.<a href="../NonEmptyList.scala.html#48413" title="=&gt; List[A]">list</a>

    <span class="comment">/**
     * Creates a string from the given non-empty list.
     */</span>
    <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[A](xs: scalaz.NonEmptyList[Char])String" id="834967">NonEmptyListString</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="834969">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.NonEmptyList[Char]" id="836173">xs</a>: <a href="../NonEmptyList.scala.html#18553" title="scalaz.NonEmptyList[Char]">NonEmptyList</a><span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#836173" title="scalaz.NonEmptyList[Char]">xs</a>.<a href="../NonEmptyList.scala.html#48413" title="=&gt; List[Char]">list</a>.<span title="=&gt; String">mkString</span>
  <span class="delimiter">}</span>

  <span class="keyword">object</span> <a title="object scalaz.http.Util.Digits" id="834958">Digits</a> <span title="ScalaObject" class="delimiter">{</span>
    <span class="comment">/**
     * Converts the given long value to a sequence of digits.
     */</span>
    <span class="keyword">def</span> <a title="[T[_]](n: Long)(implicit f: scalaz.Foldable[T], implicit p: scalaz.Pure[T], implicit e: scalaz.Empty[T], implicit plus: scalaz.Plus[T], implicit m: scalaz.Monoid[T[scalaz.Digit]])T[scalaz.Digit]" id="866566">longDigits</a><span class="delimiter">[</span><a title="[_]&gt;: Nothing &lt;: Any" id="866568">T</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="866579">_</a><span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><a title="Long" id="866573">n</a>: <span title="Long">Long</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.Foldable[T]" id="866574">f</a>: <a href="../Foldable.scala.html#14560" title="scalaz.Foldable[T]">Foldable</a><span class="delimiter">[</span>T<span class="delimiter">]</span>, <a title="scalaz.Pure[T]" id="866575">p</a>: <a href="../Pure.scala.html#19327" title="scalaz.Pure[T]">Pure</a><span class="delimiter">[</span>T<span class="delimiter">]</span>, <a title="scalaz.Empty[T]" id="866576">e</a> : <a href="../Empty.scala.html#11098" title="scalaz.Empty[T]">Empty</a><span class="delimiter">[</span>T<span class="delimiter">]</span>, <a title="scalaz.Plus[T]" id="866577">plus</a> : <a href="../Plus.scala.html#19090" title="scalaz.Plus[T]">Plus</a><span class="delimiter">[</span>T<span class="delimiter">]</span>, <a title="scalaz.Monoid[T[scalaz.Digit]]" id="866578">m</a> : <a href="../Monoid.scala.html#18205" title="scalaz.Monoid[T[scalaz.Digit]]">Monoid</a><span class="delimiter">[</span>T<span class="delimiter">[</span>Digit<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#866568" title="T[scalaz.Digit]">T</a><span class="delimiter">[</span>Digit<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="T[scalaz.Digit]" id="866586">xxx</a> = <a href="../Identity.scala.html#40089" title="(x: =&gt; Long)scalaz.Identity[Long]">n</a>.<a href="../Identity.scala.html#48623" title="(f: Long =&gt; Option[(scalaz.Digit, Long)])(implicit p: scalaz.Pure[T], implicit m: scalaz.Monoid[T[scalaz.Digit]])T[scalaz.Digit]">unfold</a><a href="#866575" title="scalaz.Pure[T]" class="delimiter">(</a><span class="delimiter">(</span>b: <span title="Long">Long</span><span class="delimiter">)</span> =&gt; <span title="Option[(scalaz.Digit, Long)]" class="keyword">if</span> <span class="delimiter">(</span><a href="#866660" title="Long">b</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span title="object None">None</span> <span class="keyword">else</span> <span title="(x: (scalaz.Digit, Long))Some[(scalaz.Digit, Long)]">Some</span><span title="(_1: scalaz.Digit, _2: Long)(scalaz.Digit, Long)" class="delimiter">(</span><a href="#866660" title="Long">b</a> <a href="../Digit.scala.html#39947" title="implicit scalaz.Digits.LongDigit : (n: Long)scalaz.Digit">%</a> <span title="Long(10L)" class="long">10L</span>: <a href="../Digit.scala.html#10930" title="scalaz.Digit">Digit</a>, <a href="#866660" title="Long">b</a> <span title="(x: Long)Long">/</span> <span title="Long(10L)" class="long">10L</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="comment">// TODO this is just a reverse, which should get into scalaz4</span>
      <span title="T[scalaz.Digit]" class="keyword">if</span> <span class="delimiter">(</span><a href="#866573" title="Long">n</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#866575" title="scalaz.Pure[T]">p</a>.<a href="../Pure.scala.html#39555" title="(a: =&gt; scalaz.Digit)T[scalaz.Digit]">pure</a><span class="delimiter">(</span><a href="../Digit.scala.html#10931" title="object scalaz.Digit">Digit</a>.<a href="../Digit.scala.html#66513" title="object scalaz.Digit._0">_0</a><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#866574" title="scalaz.Foldable[T]">f</a>.<a href="../Foldable.scala.html#82740" title="[A, B](t: T[A], z: B, f: (B, A) =&gt; B)B">foldLeft</a><span title="(t: T[scalaz.Digit], z: T[scalaz.Digit], f: (T[scalaz.Digit], scalaz.Digit) =&gt; T[scalaz.Digit])T[scalaz.Digit]" class="delimiter">[</span><a href="../Digit.scala.html#10930" title="scalaz.Digit">Digit</a>, <a href="#866568" title="T[scalaz.Digit]">T</a><span class="delimiter">[</span>Digit<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><a href="#866586" title="T[scalaz.Digit]">xxx</a>, <a href="#866576" title="scalaz.Empty[T]">e</a>.<a href="../Empty.scala.html#106123" title="[A]=&gt; T[A]">empty</a><span title="T[scalaz.Digit]" class="delimiter">[</span><a href="../Digit.scala.html#10930" title="scalaz.Digit">Digit</a><span class="delimiter">]</span>, <span class="delimiter">(</span><a title="T[scalaz.Digit]" id="866950">b</a>, <a title="scalaz.Digit" id="866951">a</a><a href="../Digit.scala.html#10930" title="scalaz.Digit" class="delimiter">)</a> =&gt; <a href="#866577" title="scalaz.Plus[T]">plus</a>.<a href="../Plus.scala.html#273014" title="(a1: T[scalaz.Digit], a2: =&gt; T[scalaz.Digit])T[scalaz.Digit]">plus</a><span class="delimiter">(</span><a href="#866575" title="scalaz.Pure[T]">p</a>.<a href="../Pure.scala.html#39555" title="(a: =&gt; scalaz.Digit)T[scalaz.Digit]">pure</a><span class="delimiter">(</span><a href="#866951" title="scalaz.Digit">a</a><span class="delimiter">)</span>, <a href="#866950" title="T[scalaz.Digit]">b</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="comment">/**
     * Converts the given sequence of digits to a long value.
     */</span>
    <span class="keyword">def</span> <a title="[T[_]](ds: T[scalaz.Digit])(implicit f: scalaz.Foldable[T])Long" id="866569">digitsLong</a><span class="delimiter">[</span><a title="[_]&gt;: Nothing &lt;: Any" id="866571">T</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="866966">_</a><span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><a title="T[scalaz.Digit]" id="866962">ds</a>: <a href="#866571" title="T[scalaz.Digit]">T</a><span class="delimiter">[</span>Digit<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.Foldable[T]" id="866963">f</a>: <a href="../Foldable.scala.html#14560" title="scalaz.Foldable[T]">Foldable</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span> =
      <a href="#866963" title="scalaz.Foldable[T]">f</a>.<a href="../Foldable.scala.html#82740" title="[A, B](t: T[A], z: B, f: (B, A) =&gt; B)B">foldLeft</a><span title="(t: T[scalaz.Digit], z: Long, f: (Long, scalaz.Digit) =&gt; Long)Long" class="delimiter">[</span><a href="../Digit.scala.html#10930" title="scalaz.Digit">Digit</a>, <span title="Long">Long</span><span class="delimiter">]</span><span class="delimiter">(</span><a href="#866962" title="T[scalaz.Digit]">ds</a>, <span title="Long(0L)" class="long">0L</span>, <span class="delimiter">(</span><a title="Long" id="866974">a</a>, <a title="scalaz.Digit" id="866975">b</a><a href="../Digit.scala.html#10930" title="scalaz.Digit" class="delimiter">)</a> =&gt; <a href="#866974" title="Long">a</a> <span title="(x: Long)Long">*</span> <span title="Long(10L)" class="long">10L</span> <span title="(x: Long)Long">+</span> <a href="../Digit.scala.html#39946" title="implicit scalaz.Digits.DigitLong : (d: scalaz.Digit)Long">b</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>