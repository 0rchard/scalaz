<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>scalaz/http/request/Uri.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scalaz
<span class="keyword">package</span> http
<span class="keyword">package</span> request

<span class="keyword">import</span> <a href="../Util.scala.html#27223" title="object scalaz.http.Util">Util</a>.<a href="../Util.scala.html#834956" title="object scalaz.http.Util.Nel">Nel</a>._
<span class="keyword">import</span> <a href="../../Scalaz.scala.html#19508" title="object scalaz.Scalaz">Scalaz</a>._

<span class="comment">/**
 * HTTP request URI.
 * &lt;a href=&quot;http://www.w3.org/Protocols/rfc2616/rfc2616-sec5.html#sec5.1.2&quot;&gt;RFC 2616 Section 5.1.2 Request-URI&lt;/a&gt;.
 *
 * @author &lt;a href=&quot;mailto:code@tmorris.net&quot;&gt;Tony Morris&lt;/a&gt;
 */</span>
<span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait Uri extends java.lang.Object with ScalaObject" id="27951">Uri</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="comment">/**
   * The path of this request URI.
   */</span>
  <span class="keyword">val</span> <a title="=&gt; scalaz.NonEmptyList[Char]" id="860601">path</a>: <a href="../../NonEmptyList.scala.html#18553" title="scalaz.NonEmptyList[Char]">NonEmptyList</a><span class="delimiter">[</span>Char<span class="delimiter">]</span>

  <span class="comment">/**
   * The query string of this request URI.
   */</span>
  <span class="keyword">val</span> <a title="=&gt; Option[List[Char]]" id="860602">queryString</a>: <span title="Option[List[Char]]">Option</span><span class="delimiter">[</span>List<span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">]</span>

  <span class="keyword">import</span> <a href="#27952" title="object scalaz.http.request.Uri">Uri</a>.uri

  <span class="comment">/**
   * Returns a request URI with the given path and this query string.
   */</span>
  <span class="keyword">def</span> <a title="(p: scalaz.NonEmptyList[Char])java.lang.Object with scalaz.http.request.Uri" id="860604">apply</a><span class="delimiter">(</span><a title="scalaz.NonEmptyList[Char]" id="882374">p</a>: <a href="../../NonEmptyList.scala.html#18553" title="scalaz.NonEmptyList[Char]">NonEmptyList</a><span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#862513" title="(p: scalaz.NonEmptyList[Char], s: Option[List[Char]])java.lang.Object with scalaz.http.request.Uri">uri</a><span class="delimiter">(</span><a href="#882374" title="scalaz.NonEmptyList[Char]">p</a>, <a href="#860602" title="=&gt; Option[List[Char]]">queryString</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Returns a request URI with the given potential query string and this path.
   */</span>
  <span class="keyword">def</span> <a title="(q: Option[List[Char]])java.lang.Object with scalaz.http.request.Uri" id="860605">apply</a><span class="delimiter">(</span><a title="Option[List[Char]]" id="882377">q</a>: <span title="Option[List[Char]]">Option</span><span class="delimiter">[</span>List<span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#862513" title="(p: scalaz.NonEmptyList[Char], s: Option[List[Char]])java.lang.Object with scalaz.http.request.Uri">uri</a><span class="delimiter">(</span><a href="#860601" title="=&gt; scalaz.NonEmptyList[Char]">path</a>, <a href="#882377" title="Option[List[Char]]">q</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Returns a request URI after applying the given transformation to the path.
   */</span>
  <span class="keyword">def</span> <a title="(f: scalaz.NonEmptyList[Char] =&gt; scalaz.NonEmptyList[Char])java.lang.Object with scalaz.http.request.Uri" id="860606">+++</a><span class="delimiter">(</span><a title="scalaz.NonEmptyList[Char] =&gt; scalaz.NonEmptyList[Char]" id="882380">f</a>: NonEmptyList<span class="delimiter">[</span>Char<span class="delimiter">]</span> =&gt; NonEmptyList<span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#862513" title="(p: scalaz.NonEmptyList[Char], s: Option[List[Char]])java.lang.Object with scalaz.http.request.Uri">uri</a><span class="delimiter">(</span><a href="#882380" title="(v1: scalaz.NonEmptyList[Char])scalaz.NonEmptyList[Char]">f</a><span class="delimiter">(</span><a href="#27951" title="Uri.this.type" class="keyword">this</a>.<a href="#860601" title="=&gt; scalaz.NonEmptyList[Char]">path</a><span class="delimiter">)</span>, <a href="#860602" title="=&gt; Option[List[Char]]">queryString</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Returns a request URI after applying the given transformation to the query string.
   */</span>
  <span class="keyword">def</span> <a title="(f: Option[List[Char]] =&gt; Option[List[Char]])java.lang.Object with scalaz.http.request.Uri" id="860607">++++</a><span class="delimiter">(</span><a title="Option[List[Char]] =&gt; Option[List[Char]]" id="882384">f</a>: Option<span class="delimiter">[</span>List<span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">]</span> =&gt; Option<span class="delimiter">[</span>List<span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#862513" title="(p: scalaz.NonEmptyList[Char], s: Option[List[Char]])java.lang.Object with scalaz.http.request.Uri">uri</a><span class="delimiter">(</span><a href="#860601" title="=&gt; scalaz.NonEmptyList[Char]">path</a>, <a href="#882384" title="(v1: Option[List[Char]])Option[List[Char]]">f</a><span class="delimiter">(</span><a href="#27951" title="Uri.this.type" class="keyword">this</a>.<a href="#860602" title="=&gt; Option[List[Char]]">queryString</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Returns the path extension - characters after the last dot (.) in the path.
   */</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="String" id="860609">pathExtension</a> = <a href="../Util.scala.html#834964" title="(xs: scalaz.NonEmptyList[Char])List[Char]">path</a>.<span title="(p: Char =&gt; Boolean)List[Char]">dropWhile</span><span class="delimiter">(</span><a href="#878973" title="Char">_</a> <span title="(x: Char)Boolean">!=</span> <span title="Char(\'.\')" class="char">'.'</span><span class="delimiter">)</span>.<span title="=&gt; List[Char]">reverse</span>.<span title="(p: Char =&gt; Boolean)List[Char]">takeWhile</span><span class="delimiter">(</span><a href="#878987" title="Char">_</a> <span title="(x: Char)Boolean">!=</span> <span title="Char(\'.\')" class="char">'.'</span><span class="delimiter">)</span>.<span title="=&gt; List[Char]">reverse</span>.<span title="=&gt; String">mkString</span>
  
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="List[String]" id="860611">parts</a> : <span title="List[String]">List</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#860601" title="=&gt; scalaz.NonEmptyList[Char]">path</a>.<a href="../../NonEmptyList.scala.html#48413" title="=&gt; List[Char]">list</a>.<span title="=&gt; List[Char]">reverse</span>.<span title="(z: List[List[Char]])(f: (List[List[Char]], Char) =&gt; List[List[Char]])List[List[Char]]">foldLeft</span><span class="delimiter">(</span><span title="[A](xs: A*)List[A]">List</span><span title="(xs: List[Char]*)List[List[Char]]" class="delimiter">[</span><span title="List[Char]">List</span><span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span title="object Nil">Nil</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="delimiter">(</span><a title="List[List[Char]]" id="882415">rs</a>, <a title="Char" id="882416">ch</a><span title="Char" class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
      <span title="List[List[Char]]" class="keyword">if</span> <span class="delimiter">(</span><a href="#882416" title="Char">ch</a> <span title="(x: Char)Boolean">==</span> <span title="Char(\'/\')" class="char">'/'</span><span class="delimiter">)</span> <span class="delimiter">{</span> <span title="object Nil">Nil</span> <a href="#882421" title="(x: List[Char])List[List[Char]]">::</a> <a href="#882415" title="List[List[Char]]">rs</a> <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span> <span class="delimiter">(</span><a href="#882416" title="Char">ch</a> <a href="#882428" title="(x: Char)List[Char]">::</a> <a href="#882415" title="List[List[Char]]">rs</a>.<span title="=&gt; List[Char]">head</span><span class="delimiter">)</span>  <a href="#882427" title="(x: List[Char])List[List[Char]]">::</a> <a href="#882415" title="List[List[Char]]">rs</a>.<span title="=&gt; List[List[Char]]">tail</span> <span class="delimiter">}</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>.<span title="(p: List[Char] =&gt; Boolean)List[List[Char]]">filter</span><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#882447" title="List[Char]">_</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span>.<span title="(f: List[Char] =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[List[Char]],String,List[String]])List[String]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,String,List[String]]" class="delimiter">(</span><a href="#882467" title="List[Char]">_</a>.<span title="=&gt; String">mkString</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">import</span> <a href="../Util.scala.html#27223" title="object scalaz.http.Util">Util</a>.<span class="delimiter">{</span>asHashMap, mapHeads<span class="delimiter">}</span>

  <span class="comment">/**
   * Returns the query string split into values by &lt;code&gt;'='&lt;/code&gt;.
   */</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Option[List[(List[Char], List[Char])]]" id="860614">parameters</a> = <a href="../../MAB.scala.html#40157" title="(a: Option[List[Char]])scalaz.MA[Option,List[Char]]">queryString</a> <a href="../../MA.scala.html#66943" title="(f: List[Char] =&gt; List[(List[Char], List[Char])])(implicit t: scalaz.Functor[Option])Option[List[(List[Char], List[Char])]]">∘</a> <span class="delimiter">(</span><a href="../Util.scala.html#27223" title="object scalaz.http.Util">Util</a>.<a href="../Util.scala.html#834931" title="(p: List[Char])List[(List[Char], List[Char])]">parameters</a><span class="delimiter">(</span><a href="#868770" title="List[Char]">_</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Returns the query string split into values by &lt;code&gt;'='&lt;/code&gt; backed with a hash map.
   */</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Option[scala.collection.immutable.Map[List[Char],scalaz.NonEmptyList[List[Char]]]]" id="860616">parametersMap</a> = <a href="../../MAB.scala.html#40157" title="(a: Option[List[(List[Char], List[Char])]])scalaz.MA[Option,List[(List[Char], List[Char])]]">parameters</a> <a href="../../MA.scala.html#66943" title="(f: List[(List[Char], List[Char])] =&gt; scala.collection.immutable.Map[List[Char],scalaz.NonEmptyList[List[Char]]])(implicit t: scalaz.Functor[Option])Option[scala.collection.immutable.Map[List[Char],scalaz.NonEmptyList[List[Char]]]]">∘</a> <span class="delimiter">(</span><a href="../Util.scala.html#834942" title="[T[_], SM[_]]=&gt; java.lang.Object with scalaz.http.Util.AsHashMap[T,SM]">asHashMap</a><a href="../Util.scala.html#837471" title="(kvs: List[(List[Char], List[Char])])(implicit f: scalaz.Foldable[List], implicit s: scalaz.Semigroup[scalaz.NonEmptyList[List[Char]]], implicit md: scalaz.Monad[scalaz.NonEmptyList])scala.collection.immutable.Map[List[Char],scalaz.NonEmptyList[List[Char]]]" class="delimiter">[</a><span title="List">List</span>, <a href="../../NonEmptyList.scala.html#18553" title="scalaz.NonEmptyList">NonEmptyList</a><span class="delimiter">]</span><a href="../../Foldable.scala.html#149140" title="=&gt; scalaz.Foldable[List]" class="delimiter">(</a><a href="#869199" title="List[(List[Char], List[Char])]">_</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Returns the query string split into values by &lt;code&gt;'='&lt;/code&gt; (removing duplicate values for a given key) backed
   * with a hash map.
   */</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Option[scala.collection.immutable.Map[List[Char],List[Char]]]" id="860618">parametersMapHeads</a> = <a href="../../MAB.scala.html#40157" title="(a: Option[scala.collection.immutable.Map[List[Char],scalaz.NonEmptyList[List[Char]]]])scalaz.MA[Option,scala.collection.immutable.Map[List[Char],scalaz.NonEmptyList[List[Char]]]]">parametersMap</a> <a href="../../MA.scala.html#66943" title="(f: scala.collection.immutable.Map[List[Char],scalaz.NonEmptyList[List[Char]]] =&gt; scala.collection.immutable.Map[List[Char],List[Char]])(implicit t: scalaz.Functor[Option])Option[scala.collection.immutable.Map[List[Char],List[Char]]]">∘</a> <span class="delimiter">(</span><a href="../Util.scala.html#834934" title="(p: scala.collection.immutable.Map[List[Char],scalaz.NonEmptyList[List[Char]]])scala.collection.immutable.Map[List[Char],List[Char]]">mapHeads</a><span class="delimiter">(</span><a href="#870398" title="scala.collection.immutable.Map[List[Char],scalaz.NonEmptyList[List[Char]]]">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait Uris extends java.lang.Object with ScalaObject" id="27957">Uris</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="comment">/**
   * Takes the given string and splits it into a URI and query string by &lt;code&gt;'?'&lt;/code&gt; character.
   */</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit scalaz.http.request.Uris.ListUri : (cs: List[Char])Option[scalaz.http.request.Uri]" id="834708">ListUri</a><span class="delimiter">(</span><a title="List[Char]" id="835636">cs</a>: <span title="List[Char]">List</span><span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Option[scalaz.http.request.Uri]">Option</span><span class="delimiter">[</span>Uri<span class="delimiter">]</span> = <a href="#835636" title="List[Char]">cs</a> <span title="Option[scalaz.http.request.Uri]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="None.type">Nil</span> =&gt; <span title="object None">None</span>
    <span class="keyword">case</span> <a title="None.type" id="882506">x</a> :: _ <span class="keyword">if</span> <a href="#882506" title="Char">x</a> <span title="(x: Char)Boolean">==</span> <span title="Char(\'?\')" class="char">'?'</span> =&gt; <span title="object None">None</span>
    <span class="keyword">case</span> <a title="Some[java.lang.Object with scalaz.http.request.Uri]" id="882515">h</a> :: <a title="List[Char]" id="882516">t</a> =&gt; <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="(List[Char], List[Char])" id="882517">z</a> = <a href="#882516" title="List[Char]">t</a>.<span title="(p: Char =&gt; Boolean)(List[Char], List[Char])">span</span><span class="delimiter">(</span><a href="#882523" title="Char">_</a> <span title="(x: Char)Boolean">!=</span> <span title="Char(\'?\')" class="char">'?'</span><span class="delimiter">)</span>
      <span title="(x: java.lang.Object with scalaz.http.request.Uri)Some[java.lang.Object with scalaz.http.request.Uri]">Some</span><span class="delimiter">(</span><a href="#27952" title="object scalaz.http.request.Uri">Uri</a>.<a href="#862513" title="(p: scalaz.NonEmptyList[Char], s: Option[List[Char]])java.lang.Object with scalaz.http.request.Uri">uri</a><span class="delimiter">(</span><a href="../../NonEmptyList.scala.html#40769" title="(h: Char, t: List[Char])scalaz.NonEmptyList[Char]">nel</a><span class="delimiter">(</span><a href="#882515" title="Char">h</a>, <a href="#882517" title="(List[Char], List[Char])">z</a>.<span title="=&gt; List[Char]">_1</span><span class="delimiter">)</span>, <a href="#882517" title="(List[Char], List[Char])">z</a>.<span title="=&gt; List[Char]">_2</span> <span title="Option[List[Char]]" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="None.type">Nil</span> =&gt; <span title="object None">None</span>
        <span class="keyword">case</span> <span title="None.type">_</span> :: <span title="object Nil">Nil</span> =&gt; <span title="object None">None</span>
        <span class="keyword">case</span> <span title="Some[List[Char]]">_</span> :: <a title="List[Char]" id="882607">k</a> =&gt; <span title="(x: List[Char])Some[List[Char]]">Some</span><span class="delimiter">(</span><a href="#882607" title="List[Char]">k</a><span class="delimiter">)</span>
      <span class="delimiter">}</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/*
 * HTTP request URI.
 * &lt;a href=&quot;http://www.w3.org/Protocols/rfc2616/rfc2616-sec5.html#sec5.1.2&quot;&gt;RFC 2616 Section 5.1.2 Request-URI&lt;/a&gt;.
 */</span>
<span class="keyword">object</span> <a title="object scalaz.http.request.Uri" id="27952">Uri</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#27957" title="scalaz.http.request.Uris">Uris</a> <span class="delimiter">{</span>
  <span class="comment">/**
   * An extractor that always matches with the URI path and query string.
   */</span>
  <span class="keyword">def</span> <a title="(uri: scalaz.http.request.Uri)Option[(scalaz.NonEmptyList[Char], Option[List[Char]])]" id="862512">unapply</a><span class="delimiter">(</span><a title="scalaz.http.request.Uri" id="882613">uri</a>: <a href="#27951" title="scalaz.http.request.Uri">Uri</a><span class="delimiter">)</span>: <span title="Option[(scalaz.NonEmptyList[Char], Option[List[Char]])]">Option</span><span class="delimiter">[</span><span class="delimiter">(</span>NonEmptyList<span class="delimiter">[</span>Char<span class="delimiter">]</span>, Option<span class="delimiter">[</span>List<span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">]</span> =
    <span title="(x: (scalaz.NonEmptyList[Char], Option[List[Char]]))Some[(scalaz.NonEmptyList[Char], Option[List[Char]])]">Some</span><span title="(_1: scalaz.NonEmptyList[Char], _2: Option[List[Char]])(scalaz.NonEmptyList[Char], Option[List[Char]])" class="delimiter">(</span><a href="#882613" title="scalaz.http.request.Uri">uri</a>.<a href="#860601" title="=&gt; scalaz.NonEmptyList[Char]">path</a>, <a href="#882613" title="scalaz.http.request.Uri">uri</a>.<a href="#860602" title="=&gt; Option[List[Char]]">queryString</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Constructs a URI with the given path and query string.
   */</span>
  <span class="keyword">def</span> <a title="(p: scalaz.NonEmptyList[Char], s: Option[List[Char]])java.lang.Object with scalaz.http.request.Uri" id="862513">uri</a><span class="delimiter">(</span><a title="scalaz.NonEmptyList[Char]" id="863684">p</a>: <a href="../../NonEmptyList.scala.html#18553" title="scalaz.NonEmptyList[Char]">NonEmptyList</a><span class="delimiter">[</span>Char<span class="delimiter">]</span>, <a title="Option[List[Char]]" id="863685">s</a>: <span title="Option[List[Char]]">Option</span><span class="delimiter">[</span>List<span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#863688" title="java.lang.Object with scalaz.http.request.Uri{}" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scalaz.http.request.Uri" id="863688">Uri</a> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scalaz.NonEmptyList[Char]" id="863690">path</a> = <a href="#863684" title="scalaz.NonEmptyList[Char]">p</a>
    <span class="keyword">val</span> <a title="Option[List[Char]]" id="863692">queryString</a> = <a href="#863685" title="Option[List[Char]]">s</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>