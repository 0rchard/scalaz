<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>scalaz/BKTree.scala</title>
        <script type="text/javascript" src="../jquery-all.js"></script>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scalaz

<span class="keyword">import</span> collection.immutable.IntMap
<span class="keyword">import</span> annotation.tailrec

<span class="comment">// http://hackage.haskell.org/packages/archive/bktrees/0.2.1/doc/html/src/Data-Set-BKTree.html</span>

<span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait BKTree[+A] extends java.lang.Object with ScalaObject" id="8843">BKTree</a><span class="delimiter">[</span>+<a title="&gt;: Nothing &lt;: Any" id="20431">A</a><span class="delimiter">]</span> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">import</span> <a href="Scalaz.scala.html#18009" title="object scalaz.Scalaz">Scalaz</a>._

  <span class="keyword">def</span> <a title="=&gt; Boolean" id="95682">isEmpty</a> : <span title="Boolean">Boolean</span> = <a href="#8843" title="BKTree.this.type" class="keyword">this</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#99105" title="object scalaz.BKTreeEmpty">BKTreeEmpty</a>

  <span class="keyword">def</span> <a title="=&gt; Int" id="95683">size</a> : <span title="Int">Int</span> = <a href="#8843" title="scalaz.BKTree[A]" class="keyword">this</a> <span title="Int" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="#99105" title="Int(0)">BKTreeEmpty</a> =&gt; <span title="Int(0)" class="int">0</span>
    <span class="keyword">case</span> <span title="Int">BKTreeNode</span><span class="delimiter">(</span>_, <a title="Int" id="95803">s</a>, _<span class="delimiter">)</span> =&gt; <a href="#95803" title="Int">s</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[AA &gt;: A](a: AA)(implicit evidence$1: scalaz.MetricSpace[AA])scalaz.BKTree[AA]" id="95806">+</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="95686">AA</a> &gt;: A : MetricSpace<span class="delimiter">]</span><span class="delimiter">(</span><a title="AA" id="95805">a</a>: <a href="#95686" title="AA">AA</a><span class="delimiter">)</span>: <a href="#8843" title="scalaz.BKTree[AA]">BKTree</a><span class="delimiter">[</span>AA<span class="delimiter">]</span> = <a href="#8843" title="scalaz.BKTree[A]" class="keyword">this</a> <span title="scalaz.BKTree[AA]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="#99105" title="scalaz.BKTreeNode[AA]">BKTreeEmpty</a> =&gt; <a href="#99263" title="(value: AA, sz: Int, children: Map[Int,scalaz.BKTree[AA]])scalaz.BKTreeNode[AA]">BKTreeNode</a><span class="delimiter">(</span><a href="#95805" title="AA">a</a>, <span title="Int(1)" class="int">1</span>, <span title="object scala.collection.immutable.IntMap">IntMap</span>.<span title="scala.collection.immutable.IntMap[Nothing]">empty</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="scalaz.BKTreeNode[AA]">BKTreeNode</span><span class="delimiter">(</span><a title="A" id="96154">v</a>, <a title="Int" id="96155">s</a>, <a title="Map[Int,scalaz.BKTree[A]]" id="96156">c</a><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Int" id="96158">d</a> = <span class="delimiter">(</span><a href="#96154" title="A">v</a>: <a href="#95686" title="AA">AA</a><span class="delimiter">)</span> <a href="Identity.scala.html#47061" title="(a: AA)(implicit m: scalaz.MetricSpace[AA])Int">&lt;===&gt;</a> <a href="#95805" title="AA">a</a>
      <a href="#99263" title="(value: AA, sz: Int, children: Map[Int,scalaz.BKTree[AA]])scalaz.BKTreeNode[AA]">BKTreeNode</a><span class="delimiter">(</span><a href="#96154" title="A">v</a>, <a href="#96155" title="Int">s</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>, <a href="#96156" title="Map[Int,scalaz.BKTree[A]]">c</a> <span title="(kv: (Int, scalaz.BKTree[AA]))scala.collection.immutable.Map[Int,scalaz.BKTree[AA]]">+</span> <span class="delimiter">(</span><span title="(_1: Int, _2: scalaz.BKTree[AA])(Int, scalaz.BKTree[AA])" class="delimiter">(</span><a href="#96158" title="Int">d</a>, <a href="#96156" title="Map[Int,scalaz.BKTree[A]]">c</a> <span title="(key: Int)Option[scalaz.BKTree[A]]">get</span> <a href="#96158" title="Int">d</a> <span title="scalaz.BKTree[AA]" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="scalaz.BKTreeNode[AA]">None</span> =&gt; <a href="#99263" title="(value: AA, sz: Int, children: Map[Int,scalaz.BKTree[AA]])scalaz.BKTreeNode[AA]">BKTreeNode</a><span class="delimiter">(</span><a href="#95805" title="AA">a</a>, <span title="Int(1)" class="int">1</span>, <span title="object scala.collection.immutable.IntMap">IntMap</span>.<span title="scala.collection.immutable.IntMap[Nothing]">empty</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="scalaz.BKTree[AA]">Some</span><span class="delimiter">(</span><a title="scalaz.BKTree[A]" id="96826">w</a><span class="delimiter">)</span> =&gt; <a href="#96826" title="scalaz.BKTree[A]">w</a> <a href="#95806" title="(a: AA)(implicit evidence$1: scalaz.MetricSpace[AA])scalaz.BKTree[AA]">+</a> <a href="#95805" title="AA">a</a>
      <span class="delimiter">}</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[AA &gt;: A](t: scalaz.BKTree[AA])(implicit evidence$2: scalaz.MetricSpace[AA])scalaz.BKTree[AA]" id="96867">++</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="95689">AA</a> &gt;: A: MetricSpace<span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.BKTree[AA]" id="96866">t</a>: <a href="#8843" title="scalaz.BKTree[AA]">BKTree</a><span class="delimiter">[</span>AA<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#8843" title="scalaz.BKTree[AA]">BKTree</a><span class="delimiter">[</span>AA<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="scalaz.BKTree[AA]" id="96871">k</a>: <a href="#8843" title="scalaz.BKTree[AA]">BKTree</a><span class="delimiter">[</span>AA<span class="delimiter">]</span> = <a href="#8843" title="scalaz.BKTree[A]" class="keyword">this</a>
    <span class="keyword">for</span><span class="delimiter">(</span><a title="AA" id="96927">v</a> &lt;- <a href="#96866" title="scalaz.BKTree[AA]">t</a>.<a href="#95690" title="(f: (AA) =&gt; Unit)Unit">values</a><span class="delimiter">)</span>
      <a href="#96871" title="scalaz.BKTree[AA]">k</a> = <a href="#96871" title="scalaz.BKTree[AA]">k</a> <a href="#95806" title="(a: AA)(implicit evidence$1: scalaz.MetricSpace[AA])scalaz.BKTree[AA]">+</a> <a href="#96927" title="AA">v</a>
    <a href="#96871" title="scalaz.BKTree[AA]">k</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; List[A]" id="95690">values</a>: <span title="List[A]">List</span><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#8843" title="scalaz.BKTree[A]" class="keyword">this</a> <span title="List[A]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="#99105" title="scala.collection.immutable.Nil.type">BKTreeEmpty</a> =&gt; <span title="object Nil">Nil</span>
    <span class="keyword">case</span> <span title="List[A]">BKTreeNode</span><span class="delimiter">(</span><a title="A" id="96976">v</a>, _, <a title="Map[Int,scalaz.BKTree[A]]" id="96977">c</a><span class="delimiter">)</span> =&gt; <a href="#96976" title="A">v</a> <a href="#96979" title="(x: A)List[A]">::</a> <a href="#96977" title="Map[Int,scalaz.BKTree[A]]">c</a>.<span title="=&gt; Iterator[scalaz.BKTree[A]]">valuesIterator</span>.<span title="=&gt; List[scalaz.BKTree[A]]">toList</span>.<span title="(f: (scalaz.BKTree[A]) =&gt; scala.collection.GenTraversableOnce[A])(implicit bf: scala.collection.generic.CanBuildFrom[List[scalaz.BKTree[A]],A,List[A]])List[A]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,A,List[A]]" class="delimiter">(</span><a href="#97020" title="scalaz.BKTree[A]">_</a>.<a href="#95690" title="=&gt; List[A]">values</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  @tailrec
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="[AA &gt;: A](a: AA)(implicit evidence$3: scalaz.MetricSpace[AA])Boolean" id="97144">-?-</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="95693">AA</a> &gt;: A: MetricSpace<span class="delimiter">]</span><span class="delimiter">(</span><a title="AA" id="97143">a</a>: <a href="#95693" title="AA">AA</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#8843" title="scalaz.BKTree[A]" class="keyword">this</a> <span title="Boolean" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="#99105" title="Boolean(false)">BKTreeEmpty</a> =&gt; <span title="Boolean(false)" class="keyword">false</span>
    <span class="keyword">case</span> <span title="Boolean">BKTreeNode</span><span class="delimiter">(</span><a title="A" id="97153">v</a>, _, <a title="Map[Int,scalaz.BKTree[A]]" id="97154">c</a><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Int" id="97156">d</a> = <span class="delimiter">(</span><a href="#97153" title="A">v</a>: <a href="#95693" title="AA">AA</a><span class="delimiter">)</span> <a href="Identity.scala.html#47061" title="(a: AA)(implicit m: scalaz.MetricSpace[AA])Int">&lt;===&gt;</a> <a href="#97143" title="AA">a</a>
      <a href="#97156" title="Int">d</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span> <span title="(x: Boolean)Boolean">||</span> <span class="delimiter">(</span><a href="#97154" title="Map[Int,scalaz.BKTree[A]]">c</a> <span title="(key: Int)Option[scalaz.BKTree[A]]">get</span> <a href="#97156" title="Int">d</a> <span title="Boolean" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="Boolean(false)">None</span> =&gt; <span title="Boolean(false)" class="keyword">false</span>
        <span class="keyword">case</span> <span title="Boolean">Some</span><span class="delimiter">(</span><a title="scalaz.BKTree[A]" id="97414">w</a><span class="delimiter">)</span> =&gt; <a href="#97414" title="scalaz.BKTree[A]">w</a> <a href="#97144" title="(a: AA)(implicit evidence$3: scalaz.MetricSpace[AA])Boolean">-?-</a> <a href="#97143" title="AA">a</a>
      <span class="delimiter">}</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[AA &gt;: A](a: AA, n: Int)(implicit evidence$4: scalaz.MetricSpace[AA])Boolean" id="97428">=?=</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="95696">AA</a> &gt;: A: MetricSpace<span class="delimiter">]</span><span class="delimiter">(</span><a title="AA" id="97426">a</a>: <a href="#95696" title="AA">AA</a>, <a title="Int" id="97427">n</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#8843" title="scalaz.BKTree[A]" class="keyword">this</a> <span title="Boolean" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="#99105" title="Boolean(false)">BKTreeEmpty</a> =&gt; <span title="Boolean(false)" class="keyword">false</span>
    <span class="keyword">case</span> <span title="Boolean">BKTreeNode</span><span class="delimiter">(</span><a title="A" id="97436">v</a>, _, <a title="Map[Int,scalaz.BKTree[A]]" id="97437">c</a><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Int" id="97439">d</a> = <span class="delimiter">(</span><a href="#97436" title="A">v</a>: <a href="#95696" title="AA">AA</a><span class="delimiter">)</span> <a href="Identity.scala.html#47061" title="(a: AA)(implicit m: scalaz.MetricSpace[AA])Int">&lt;===&gt;</a> <a href="#97426" title="AA">a</a>
      <a href="#97439" title="Int">d</a> <span title="(x: Int)Boolean">&lt;=</span> <a href="#97427" title="Int">n</a> <span title="(x: Boolean)Boolean">||</span> <span class="delimiter">(</span><a href="#95700" title="(d: Int, n: Int)Map[Int,scalaz.BKTree[A]]">subChildren</a><span class="delimiter">(</span><a href="#97439" title="Int">d</a>, <a href="#97427" title="Int">n</a><span class="delimiter">)</span> <span title="(p: ((Int, scalaz.BKTree[A])) =&gt; Boolean)Boolean">exists</span> <span class="delimiter">(</span><a href="#98167" title="(Int, scalaz.BKTree[A])">_</a>.<span title="=&gt; scalaz.BKTree[A]">_2</span> <a href="#97428" title="(a: AA, n: Int)(implicit evidence$4: scalaz.MetricSpace[AA])Boolean">=?=</a> <span class="delimiter">(</span><a href="#97426" title="AA">a</a>, <a href="#97427" title="Int">n</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[AA &gt;: A](a: AA, n: Int)(implicit evidence$5: scalaz.MetricSpace[AA])List[AA]" id="98183">|=|</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="95699">AA</a> &gt;: A: MetricSpace<span class="delimiter">]</span><span class="delimiter">(</span><a title="AA" id="98181">a</a>: <a href="#95699" title="AA">AA</a>, <a title="Int" id="98182">n</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="List[AA]">List</span><span class="delimiter">[</span>AA<span class="delimiter">]</span> = <a href="#8843" title="scalaz.BKTree[A]" class="keyword">this</a> <span title="List[AA]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="#99105" title="scala.collection.immutable.Nil.type">BKTreeEmpty</a> =&gt; <span title="object Nil">Nil</span>
    <span class="keyword">case</span> <span title="List[AA]">BKTreeNode</span><span class="delimiter">(</span><a title="A" id="98191">v</a>, _, <a title="Map[Int,scalaz.BKTree[A]]" id="98192">c</a><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Int" id="98194">d</a> = <span class="delimiter">(</span><a href="#98191" title="A">v</a>: <a href="#95699" title="AA">AA</a><span class="delimiter">)</span> <a href="Identity.scala.html#47061" title="(a: AA)(implicit m: scalaz.MetricSpace[AA])Int">&lt;===&gt;</a> <a href="#98181" title="AA">a</a>
      <span class="keyword">val</span> <a title="List[AA]" id="98195">k</a> = <a href="#95700" title="(d: Int, n: Int)Map[Int,scalaz.BKTree[A]]">subChildren</a><span class="delimiter">(</span><a href="#98194" title="Int">d</a>, <a href="#98182" title="Int">n</a><span class="delimiter">)</span>.<span title="=&gt; Iterator[scalaz.BKTree[A]]">valuesIterator</span>.<span title="=&gt; List[scalaz.BKTree[A]]">toList</span> <span title="(f: (scalaz.BKTree[A]) =&gt; scala.collection.GenTraversableOnce[AA])(implicit bf: scala.collection.generic.CanBuildFrom[List[scalaz.BKTree[A]],AA,List[AA]])List[AA]">flatMap</span> <span class="delimiter">(</span><a href="#98466" title="scalaz.BKTree[A]">_</a> <a href="#98183" title="(a: AA, n: Int)(implicit evidence$5: scalaz.MetricSpace[AA])List[AA]">|=|</a> <span class="delimiter">(</span><a href="#98181" title="AA">a</a>, <a href="#98182" title="Int">n</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span title="List[AA]" class="keyword">if</span><span class="delimiter">(</span><a href="#98194" title="Int">d</a> <span title="(x: Int)Boolean">&lt;=</span> <a href="#98182" title="Int">n</a><span class="delimiter">)</span>
        <a href="#98191" title="A">v</a> <a href="#98512" title="(x: AA)List[AA]">::</a> <a href="#98195" title="List[AA]">k</a>
      <span class="keyword">else</span>
        <a href="#98195" title="List[AA]">k</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="[AA &gt;: A](d: Int, n: Int)Map[Int,scalaz.BKTree[A]]" id="95700">subChildren</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="95702">AA</a> &gt;: A<span class="delimiter">]</span><span class="delimiter">(</span><a title="Int" id="97693">d</a>: <span title="Int">Int</span>, <a title="Int" id="97694">n</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <a href="#8843" title="scalaz.BKTree[A]" class="keyword">this</a> <span title="Map[Int,scalaz.BKTree[A]]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="#99105" title="scala.collection.immutable.IntMap[Nothing]">BKTreeEmpty</a> =&gt; <span title="object scala.collection.immutable.IntMap">IntMap</span>.<span title="scala.collection.immutable.IntMap[Nothing]">empty</span>
    <span class="keyword">case</span> <span title="Map[Int,scalaz.BKTree[A]]">BKTreeNode</span><span class="delimiter">(</span>_, _, <a title="Map[Int,scalaz.BKTree[A]]" id="97713">c</a><span class="delimiter">)</span> =&gt; <a href="#95703" title="(m: Map[Int,scalaz.BKTree[A]], d: Int, n: Int)Map[Int,scalaz.BKTree[A]]">subMap</a><span class="delimiter">(</span><a href="#97713" title="Map[Int,scalaz.BKTree[A]]">c</a>, <a href="#97693" title="Int">d</a>, <a href="#97694" title="Int">n</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="[AA &gt;: A](m: Map[Int,scalaz.BKTree[AA]], d: Int, n: Int)Map[Int,scalaz.BKTree[AA]]" id="95703">subMap</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="95705">AA</a> &gt;: A<span class="delimiter">]</span><span class="delimiter">(</span><a title="Map[Int,scalaz.BKTree[AA]]" id="97715">m</a>: <span title="Map[Int,scalaz.BKTree[AA]]">Map</span><span class="delimiter">[</span>Int, BKTree<span class="delimiter">[</span>AA<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="Int" id="97716">d</a>: <span title="Int">Int</span>, <a title="Int" id="97717">n</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <a href="#95709" title="(m: Map[Int,scalaz.BKTree[AA]], k: Int)(Map[Int,scalaz.BKTree[AA]], Map[Int,scalaz.BKTree[AA]])">splitMap</a><span class="delimiter">(</span><a href="#95709" title="(m: Map[Int,scalaz.BKTree[AA]], k: Int)(Map[Int,scalaz.BKTree[AA]], Map[Int,scalaz.BKTree[AA]])">splitMap</a><span class="delimiter">(</span><a href="#97715" title="Map[Int,scalaz.BKTree[AA]]">m</a>, <a href="#97716" title="Int">d</a> <span title="(x: Int)Int">-</span> <a href="#97717" title="Int">n</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<span title="=&gt; Map[Int,scalaz.BKTree[AA]]">_2</span>, <a href="#97716" title="Int">d</a> <span title="(x: Int)Int">+</span> <a href="#97717" title="Int">n</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<span title="=&gt; Map[Int,scalaz.BKTree[AA]]">_1</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="[AA &gt;: A](k: Int)(Map[Int,scalaz.BKTree[AA]], Map[Int,scalaz.BKTree[AA]])" id="95706">splitChildren</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="95708">AA</a> &gt;: A<span class="delimiter">]</span><span class="delimiter">(</span><a title="Int" id="98519">k</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="(Map[Int,scalaz.BKTree[AA]], Map[Int,scalaz.BKTree[AA]])" class="delimiter">(</span>Map<span class="delimiter">[</span>Int, BKTree<span class="delimiter">[</span>AA<span class="delimiter">]</span><span class="delimiter">]</span>, Map<span class="delimiter">[</span>Int, BKTree<span class="delimiter">[</span>AA<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#8843" title="scalaz.BKTree[A]" class="keyword">this</a> <span title="(Map[Int,scalaz.BKTree[AA]], Map[Int,scalaz.BKTree[AA]])" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="#99105" title="(scala.collection.immutable.IntMap[Nothing], scala.collection.immutable.IntMap[Nothing])">BKTreeEmpty</a> =&gt; <span title="(_1: scala.collection.immutable.IntMap[Nothing], _2: scala.collection.immutable.IntMap[Nothing])(scala.collection.immutable.IntMap[Nothing], scala.collection.immutable.IntMap[Nothing])" class="delimiter">(</span><span title="object scala.collection.immutable.IntMap">IntMap</span>.<span title="scala.collection.immutable.IntMap[Nothing]">empty</span>, <span title="object scala.collection.immutable.IntMap">IntMap</span>.<span title="scala.collection.immutable.IntMap[Nothing]">empty</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="(Map[Int,scalaz.BKTree[A]], Map[Int,scalaz.BKTree[A]])">BKTreeNode</span><span class="delimiter">(</span>_, _, <a title="Map[Int,scalaz.BKTree[A]]" id="98568">c</a><span class="delimiter">)</span> =&gt; <a href="#95709" title="(m: Map[Int,scalaz.BKTree[A]], k: Int)(Map[Int,scalaz.BKTree[A]], Map[Int,scalaz.BKTree[A]])">splitMap</a><span class="delimiter">(</span><a href="#98568" title="Map[Int,scalaz.BKTree[A]]">c</a>, <a href="#98519" title="Int">k</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="[AA &gt;: A](m: Map[Int,scalaz.BKTree[AA]], k: Int)(Map[Int,scalaz.BKTree[AA]], Map[Int,scalaz.BKTree[AA]])" id="95709">splitMap</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="95711">AA</a> &gt;: A<span class="delimiter">]</span><span class="delimiter">(</span><a title="Map[Int,scalaz.BKTree[AA]]" id="97720">m</a>: <span title="Map[Int,scalaz.BKTree[AA]]">Map</span><span class="delimiter">[</span>Int, BKTree<span class="delimiter">[</span>AA<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="Int" id="97721">k</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="(Map[Int,scalaz.BKTree[AA]], Map[Int,scalaz.BKTree[AA]])" class="delimiter">(</span>Map<span class="delimiter">[</span>Int, BKTree<span class="delimiter">[</span>AA<span class="delimiter">]</span><span class="delimiter">]</span>, Map<span class="delimiter">[</span>Int, BKTree<span class="delimiter">[</span>AA<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Map[Int,scalaz.BKTree[AA]]" id="98587">m1</a>: <span title="Map[Int,scalaz.BKTree[AA]]">Map</span><span class="delimiter">[</span>Int, BKTree<span class="delimiter">[</span>AA<span class="delimiter">]</span><span class="delimiter">]</span> = <span title="object scala.collection.immutable.IntMap">IntMap</span>.<span title="scala.collection.immutable.IntMap[Nothing]">empty</span>
    <span class="keyword">var</span> <a title="Map[Int,scalaz.BKTree[AA]]" id="98588">m2</a>: <span title="Map[Int,scalaz.BKTree[AA]]">Map</span><span class="delimiter">[</span>Int, BKTree<span class="delimiter">[</span>AA<span class="delimiter">]</span><span class="delimiter">]</span> = <span title="object scala.collection.immutable.IntMap">IntMap</span>.<span title="scala.collection.immutable.IntMap[Nothing]">empty</span>
    <span class="keyword">for</span><span class="delimiter">(</span><span class="delimiter">(</span><a title="Int" id="98651">i</a>, <a title="scalaz.BKTree[AA]" id="98652">v</a><span class="delimiter">)</span> &lt;- <a href="#97720" title="Map[Int,scalaz.BKTree[AA]]">m</a>.<a href="#98628" title="(f: ((Int, scalaz.BKTree[AA])) =&gt; Unit)Unit">iterator</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#98651" title="Int">i</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#97721" title="Int">k</a><span class="delimiter">)</span>
        <a href="#98587" title="Map[Int,scalaz.BKTree[AA]]">m1</a> = <a href="#98587" title="Map[Int,scalaz.BKTree[AA]]">m1</a> <span title="(kv: (Int, scalaz.BKTree[AA]))scala.collection.immutable.Map[Int,scalaz.BKTree[AA]]">+</span> <span class="delimiter">(</span><span title="(_1: Int, _2: scalaz.BKTree[AA])(Int, scalaz.BKTree[AA])" class="delimiter">(</span><a href="#98651" title="Int">i</a>, <a href="#98652" title="scalaz.BKTree[AA]">v</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">else</span> <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#98651" title="Int">i</a> <span title="(x: Int)Boolean">&gt;</span> <a href="#97721" title="Int">k</a><span class="delimiter">)</span>
        <a href="#98588" title="Map[Int,scalaz.BKTree[AA]]">m2</a> = <a href="#98588" title="Map[Int,scalaz.BKTree[AA]]">m2</a> <span title="(kv: (Int, scalaz.BKTree[AA]))scala.collection.immutable.Map[Int,scalaz.BKTree[AA]]">+</span> <span class="delimiter">(</span><span title="(_1: Int, _2: scalaz.BKTree[AA])(Int, scalaz.BKTree[AA])" class="delimiter">(</span><a href="#98651" title="Int">i</a>, <a href="#98652" title="scalaz.BKTree[AA]">v</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span title="(_1: Map[Int,scalaz.BKTree[AA]], _2: Map[Int,scalaz.BKTree[AA]])(Map[Int,scalaz.BKTree[AA]], Map[Int,scalaz.BKTree[AA]])" class="delimiter">(</span><a href="#98587" title="Map[Int,scalaz.BKTree[AA]]">m1</a>, <a href="#98588" title="Map[Int,scalaz.BKTree[AA]]">m2</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>
<span class="keyword">private</span> <span class="keyword">final</span> case <span class="keyword">class</span> <a title="class BKTreeNode[+A] extends java.lang.Object with scalaz.BKTree[A] with ScalaObject with Product with Serializable" id="99263">BKTreeNode</a><span class="delimiter">[</span>+<a title="&gt;: Nothing &lt;: Any" id="95728">A</a><span class="delimiter">]</span><a href="#99263" title="ScalaObject" class="delimiter">(</a><a title="A" id="95810">value</a>: <a href="#95728" title="A">A</a>, <a title="Int" id="95811">sz</a>: <span title="Int">Int</span>, <a title="Map[Int,scalaz.BKTree[A]]" id="95812">children</a>: <span title="Map[Int,scalaz.BKTree[A]]">Map</span><span class="delimiter">[</span>Int, BKTree<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#8843" title="scalaz.BKTree[A]">BKTree</a><span class="delimiter">[</span>A<span class="delimiter">]</span>
<span class="keyword">private</span> case <span class="keyword">object</span> <a href="#99097" title="object scalaz.BKTreeEmpty" id="99105">BKTreeEmpty</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#8843" title="scalaz.BKTree[Nothing]">BKTree</a><span class="delimiter">[</span>Nothing<span class="delimiter">]</span>

<span class="keyword">trait</span> <a title="trait BKTrees extends java.lang.Object with ScalaObject" id="8858">BKTrees</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="[A]=&gt; scalaz.BKTree[A]" id="38364">emptyBKTree</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="38366">A</a><span class="delimiter">]</span>: <a href="#8843" title="scalaz.BKTree[A]">BKTree</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#99105" title="object scalaz.BKTreeEmpty">BKTreeEmpty</a>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>