<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>scalaz/http/request/Uri.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scalaz
<span class="keyword">package</span> http
<span class="keyword">package</span> request

<span class="keyword">import</span> <a href="../Util.scala.html#25561" title="object scalaz.http.Util">Util</a>.<a href="../Util.scala.html#1106678" title="object scalaz.http.Util.Nel">Nel</a>._
<span class="keyword">import</span> <a href="../../Scalaz.scala.html#18009" title="object scalaz.Scalaz">Scalaz</a>._

<span class="comment">/**
 * HTTP request URI.
 * &lt;a href=&quot;http://www.w3.org/Protocols/rfc2616/rfc2616-sec5.html#sec5.1.2&quot;&gt;RFC 2616 Section 5.1.2 Request-URI&lt;/a&gt;.
 *
 * @author &lt;a href=&quot;mailto:code@tmorris.net&quot;&gt;Tony Morris&lt;/a&gt;
 */</span>
<span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait Uri extends java.lang.Object with ScalaObject" id="26289">Uri</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="comment">/**
   * The path of this request URI.
   */</span>
  <span class="keyword">val</span> <a title="=&gt; scalaz.NonEmptyList[Char]" id="1140057">path</a>: <a href="../../NonEmptyList.scala.html#17054" title="scalaz.NonEmptyList[Char]">NonEmptyList</a><span class="delimiter">[</span>Char<span class="delimiter">]</span>

  <span class="comment">/**
   * The query string of this request URI.
   */</span>
  <span class="keyword">val</span> <a title="=&gt; Option[List[Char]]" id="1140058">queryString</a>: <span title="Option[List[Char]]">Option</span><span class="delimiter">[</span>List<span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">]</span>

  <span class="keyword">import</span> <a href="#26290" title="object scalaz.http.request.Uri">Uri</a>.uri

  <span class="comment">/**
   * Returns a request URI with the given path and this query string.
   */</span>
  <span class="keyword">def</span> <a title="(p: scalaz.NonEmptyList[Char])java.lang.Object with scalaz.http.request.Uri" id="1140060">apply</a><span class="delimiter">(</span><a title="scalaz.NonEmptyList[Char]" id="1180030">p</a>: <a href="../../NonEmptyList.scala.html#17054" title="scalaz.NonEmptyList[Char]">NonEmptyList</a><span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#1142494" title="(p: scalaz.NonEmptyList[Char], s: Option[List[Char]])java.lang.Object with scalaz.http.request.Uri">uri</a><span class="delimiter">(</span><a href="#1180030" title="scalaz.NonEmptyList[Char]">p</a>, <a href="#1140058" title="=&gt; Option[List[Char]]">queryString</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Returns a request URI with the given potential query string and this path.
   */</span>
  <span class="keyword">def</span> <a title="(q: Option[List[Char]])java.lang.Object with scalaz.http.request.Uri" id="1140061">apply</a><span class="delimiter">(</span><a title="Option[List[Char]]" id="1180034">q</a>: <span title="Option[List[Char]]">Option</span><span class="delimiter">[</span>List<span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#1142494" title="(p: scalaz.NonEmptyList[Char], s: Option[List[Char]])java.lang.Object with scalaz.http.request.Uri">uri</a><span class="delimiter">(</span><a href="#1140057" title="=&gt; scalaz.NonEmptyList[Char]">path</a>, <a href="#1180034" title="Option[List[Char]]">q</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Returns a request URI after applying the given transformation to the path.
   */</span>
  <span class="keyword">def</span> <a title="(f: (scalaz.NonEmptyList[Char]) =&gt; scalaz.NonEmptyList[Char])java.lang.Object with scalaz.http.request.Uri" id="1140062">+++</a><span class="delimiter">(</span><a title="(scalaz.NonEmptyList[Char]) =&gt; scalaz.NonEmptyList[Char]" id="1180038">f</a>: NonEmptyList<span class="delimiter">[</span>Char<span class="delimiter">]</span> =&gt; NonEmptyList<span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#1142494" title="(p: scalaz.NonEmptyList[Char], s: Option[List[Char]])java.lang.Object with scalaz.http.request.Uri">uri</a><span class="delimiter">(</span><a href="#1180038" title="(v1: scalaz.NonEmptyList[Char])scalaz.NonEmptyList[Char]">f</a><span class="delimiter">(</span><a href="#26289" title="Uri.this.type" class="keyword">this</a>.<a href="#1140057" title="=&gt; scalaz.NonEmptyList[Char]">path</a><span class="delimiter">)</span>, <a href="#1140058" title="=&gt; Option[List[Char]]">queryString</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Returns a request URI after applying the given transformation to the query string.
   */</span>
  <span class="keyword">def</span> <a title="(f: (Option[List[Char]]) =&gt; Option[List[Char]])java.lang.Object with scalaz.http.request.Uri" id="1140063">++++</a><span class="delimiter">(</span><a title="(Option[List[Char]]) =&gt; Option[List[Char]]" id="1180044">f</a>: Option<span class="delimiter">[</span>List<span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">]</span> =&gt; Option<span class="delimiter">[</span>List<span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#1142494" title="(p: scalaz.NonEmptyList[Char], s: Option[List[Char]])java.lang.Object with scalaz.http.request.Uri">uri</a><span class="delimiter">(</span><a href="#1140057" title="=&gt; scalaz.NonEmptyList[Char]">path</a>, <a href="#1180044" title="(v1: Option[List[Char]])Option[List[Char]]">f</a><span class="delimiter">(</span><a href="#26289" title="Uri.this.type" class="keyword">this</a>.<a href="#1140058" title="=&gt; Option[List[Char]]">queryString</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Returns the path extension - characters after the last dot (.) in the path.
   */</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="String" id="1140065">pathExtension</a> = <a href="../Util.scala.html#1106686" title="(xs: scalaz.NonEmptyList[Char])List[Char]">path</a>.<span title="(p: (Char) =&gt; Boolean)List[Char]">dropWhile</span><span class="delimiter">(</span><a href="#1175905" title="Char">_</a> <span title="(x: Char)Boolean">!=</span> <span title="Char(\'.\')" class="char">'.'</span><span class="delimiter">)</span>.<span title="=&gt; List[Char]">reverse</span>.<span title="(p: (Char) =&gt; Boolean)List[Char]">takeWhile</span><span class="delimiter">(</span><a href="#1175921" title="Char">_</a> <span title="(x: Char)Boolean">!=</span> <span title="Char(\'.\')" class="char">'.'</span><span class="delimiter">)</span>.<span title="=&gt; List[Char]">reverse</span>.<span title="=&gt; String">mkString</span>
  
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="List[String]" id="1140067">parts</a> : <span title="List[String]">List</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#1140057" title="=&gt; scalaz.NonEmptyList[Char]">path</a>.<a href="../../NonEmptyList.scala.html#46858" title="=&gt; List[Char]">list</a>.<span title="=&gt; List[Char]">reverse</span>.<span title="(z: List[List[Char]])(f: (List[List[Char]], Char) =&gt; List[List[Char]])List[List[Char]]">foldLeft</span><span class="delimiter">(</span><span title="[A](xs: A*)List[A]">List</span><span title="(xs: List[Char]*)List[List[Char]]" class="delimiter">[</span><span title="List[Char]">List</span><span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span title="object Nil">Nil</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="delimiter">(</span><a title="List[List[Char]]" id="1180079">rs</a>, <a title="Char" id="1180080">ch</a><span title="Char" class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
      <span title="List[List[Char]]" class="keyword">if</span> <span class="delimiter">(</span><a href="#1180080" title="Char">ch</a> <span title="(x: Char)Boolean">==</span> <span title="Char(\'/\')" class="char">'/'</span><span class="delimiter">)</span> <span class="delimiter">{</span> <span title="object Nil">Nil</span> <a href="#1180086" title="(x: List[Char])List[List[Char]]">::</a> <a href="#1180079" title="List[List[Char]]">rs</a> <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span> <span class="delimiter">(</span><a href="#1180080" title="Char">ch</a> <a href="#1180094" title="(x: Char)List[Char]">::</a> <a href="#1180079" title="List[List[Char]]">rs</a>.<span title="=&gt; List[Char]">head</span><span class="delimiter">)</span>  <a href="#1180093" title="(x: List[Char])List[List[Char]]">::</a> <a href="#1180079" title="List[List[Char]]">rs</a>.<span title="=&gt; List[List[Char]]">tail</span> <span class="delimiter">}</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>.<span title="(p: (List[Char]) =&gt; Boolean)List[List[Char]]">filter</span><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#1180116" title="List[Char]">_</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span>.<span title="(f: (List[Char]) =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[List[Char]],String,List[String]])List[String]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,String,List[String]]" class="delimiter">(</span><a href="#1180137" title="List[Char]">_</a>.<span title="=&gt; String">mkString</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">import</span> <a href="../Util.scala.html#25561" title="object scalaz.http.Util">Util</a>.<span class="delimiter">{</span>asHashMap, mapHeads<span class="delimiter">}</span>

  <span class="comment">/**
   * Returns the query string split into values by &lt;code&gt;'='&lt;/code&gt;.
   */</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Option[List[(List[Char], List[Char])]]" id="1140070">parameters</a> = <a href="../../MA.scala.html#38611" title="(a: Option[List[Char]])scalaz.MA[Option,List[Char]]">queryString</a> <a href="../../MA.scala.html#65497" title="(f: (List[Char]) =&gt; List[(List[Char], List[Char])])(implicit t: scalaz.Functor[Option])Option[List[(List[Char], List[Char])]]">∘</a> <span class="delimiter">(</span><a href="../Util.scala.html#25561" title="object scalaz.http.Util">Util</a>.<a href="../Util.scala.html#1106653" title="(p: List[Char])List[(List[Char], List[Char])]">parameters</a><span class="delimiter">(</span><a href="#1158818" title="List[Char]">_</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Returns the query string split into values by &lt;code&gt;'='&lt;/code&gt; backed with a hash map.
   */</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Option[scala.collection.immutable.Map[List[Char],scalaz.NonEmptyList[List[Char]]]]" id="1140072">parametersMap</a> = <a href="../../MA.scala.html#38611" title="(a: Option[List[(List[Char], List[Char])]])scalaz.MA[Option,List[(List[Char], List[Char])]]">parameters</a> <a href="../../MA.scala.html#65497" title="(f: (List[(List[Char], List[Char])]) =&gt; scala.collection.immutable.Map[List[Char],scalaz.NonEmptyList[List[Char]]])(implicit t: scalaz.Functor[Option])Option[scala.collection.immutable.Map[List[Char],scalaz.NonEmptyList[List[Char]]]]">∘</a> <span class="delimiter">(</span><a href="../Util.scala.html#1106664" title="[T[_], SM[_]]=&gt; java.lang.Object with scalaz.http.Util.AsHashMap[T,SM]">asHashMap</a><a href="../Util.scala.html#1109568" title="(kvs: List[(List[Char], List[Char])])(implicit f: scalaz.Foldable[List], implicit s: scalaz.Semigroup[scalaz.NonEmptyList[List[Char]]], implicit md: scalaz.Monad[scalaz.NonEmptyList])scala.collection.immutable.Map[List[Char],scalaz.NonEmptyList[List[Char]]]" class="delimiter">[</a><span title="List">List</span>, <a href="../../NonEmptyList.scala.html#17054" title="scalaz.NonEmptyList">NonEmptyList</a><span class="delimiter">]</span><a href="../../Foldable.scala.html#106964" title="=&gt; scalaz.Foldable[List]" class="delimiter">(</a><a href="#1159409" title="List[(List[Char], List[Char])]">_</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Returns the query string split into values by &lt;code&gt;'='&lt;/code&gt; (removing duplicate values for a given key) backed
   * with a hash map.
   */</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Option[scala.collection.immutable.Map[List[Char],List[Char]]]" id="1140074">parametersMapHeads</a> = <a href="../../MA.scala.html#38611" title="(a: Option[scala.collection.immutable.Map[List[Char],scalaz.NonEmptyList[List[Char]]]])scalaz.MA[Option,scala.collection.immutable.Map[List[Char],scalaz.NonEmptyList[List[Char]]]]">parametersMap</a> <a href="../../MA.scala.html#65497" title="(f: (scala.collection.immutable.Map[List[Char],scalaz.NonEmptyList[List[Char]]]) =&gt; scala.collection.immutable.Map[List[Char],List[Char]])(implicit t: scalaz.Functor[Option])Option[scala.collection.immutable.Map[List[Char],List[Char]]]">∘</a> <span class="delimiter">(</span><a href="../Util.scala.html#1106656" title="(p: scala.collection.immutable.Map[List[Char],scalaz.NonEmptyList[List[Char]]])scala.collection.immutable.Map[List[Char],List[Char]]">mapHeads</a><span class="delimiter">(</span><a href="#1160772" title="scala.collection.immutable.Map[List[Char],scalaz.NonEmptyList[List[Char]]]">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait Uris extends java.lang.Object with ScalaObject" id="26295">Uris</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="comment">/**
   * Takes the given string and splits it into a URI and query string by &lt;code&gt;'?'&lt;/code&gt; character.
   */</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit scalaz.http.request.Uris.ListUri : (cs: List[Char])Option[scalaz.http.request.Uri]" id="1106430">ListUri</a><span class="delimiter">(</span><a title="List[Char]" id="1107379">cs</a>: <span title="List[Char]">List</span><span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Option[scalaz.http.request.Uri]">Option</span><span class="delimiter">[</span>Uri<span class="delimiter">]</span> = <a href="#1107379" title="List[Char]">cs</a> <span title="Option[scalaz.http.request.Uri]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="None.type">Nil</span> =&gt; <span title="object None">None</span>
    <span class="keyword">case</span> <a title="None.type" id="1180178">x</a> :: _ <span class="keyword">if</span> <a href="#1180178" title="Char">x</a> <span title="(x: Char)Boolean">==</span> <span title="Char(\'?\')" class="char">'?'</span> =&gt; <span title="object None">None</span>
    <span class="keyword">case</span> <a title="Some[java.lang.Object with scalaz.http.request.Uri]" id="1180189">h</a> :: <a title="List[Char]" id="1180190">t</a> =&gt; <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="(List[Char], List[Char])" id="1180192">z</a> = <a href="#1180190" title="List[Char]">t</a>.<span title="(p: (Char) =&gt; Boolean)(List[Char], List[Char])">span</span><span class="delimiter">(</span><a href="#1180198" title="Char">_</a> <span title="(x: Char)Boolean">!=</span> <span title="Char(\'?\')" class="char">'?'</span><span class="delimiter">)</span>
      <span title="(x: java.lang.Object with scalaz.http.request.Uri)Some[java.lang.Object with scalaz.http.request.Uri]">Some</span><span class="delimiter">(</span><a href="#26290" title="object scalaz.http.request.Uri">Uri</a>.<a href="#1142494" title="(p: scalaz.NonEmptyList[Char], s: Option[List[Char]])java.lang.Object with scalaz.http.request.Uri">uri</a><span class="delimiter">(</span><a href="../../NonEmptyList.scala.html#39232" title="(h: Char, t: List[Char])scalaz.NonEmptyList[Char]">nel</a><span class="delimiter">(</span><a href="#1180189" title="Char">h</a>, <a href="#1180192" title="(List[Char], List[Char])">z</a>.<span title="=&gt; List[Char]">_1</span><span class="delimiter">)</span>, <a href="#1180192" title="(List[Char], List[Char])">z</a>.<span title="=&gt; List[Char]">_2</span> <span title="Option[List[Char]]" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="None.type">Nil</span> =&gt; <span title="object None">None</span>
        <span class="keyword">case</span> <span title="None.type">_</span> :: <span title="object Nil">Nil</span> =&gt; <span title="object None">None</span>
        <span class="keyword">case</span> <span title="Some[List[Char]]">_</span> :: <a title="List[Char]" id="1180280">k</a> =&gt; <span title="(x: List[Char])Some[List[Char]]">Some</span><span class="delimiter">(</span><a href="#1180280" title="List[Char]">k</a><span class="delimiter">)</span>
      <span class="delimiter">}</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/*
 * HTTP request URI.
 * &lt;a href=&quot;http://www.w3.org/Protocols/rfc2616/rfc2616-sec5.html#sec5.1.2&quot;&gt;RFC 2616 Section 5.1.2 Request-URI&lt;/a&gt;.
 */</span>
<span class="keyword">object</span> <a title="object scalaz.http.request.Uri" id="26290">Uri</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#26295" title="scalaz.http.request.Uris">Uris</a> <span class="delimiter">{</span>
  <span class="comment">/**
   * An extractor that always matches with the URI path and query string.
   */</span>
  <span class="keyword">def</span> <a title="(uri: scalaz.http.request.Uri)Option[(scalaz.NonEmptyList[Char], Option[List[Char]])]" id="1142493">unapply</a><span class="delimiter">(</span><a title="scalaz.http.request.Uri" id="1180291">uri</a>: <a href="#26289" title="scalaz.http.request.Uri">Uri</a><span class="delimiter">)</span>: <span title="Option[(scalaz.NonEmptyList[Char], Option[List[Char]])]">Option</span><span class="delimiter">[</span><span class="delimiter">(</span>NonEmptyList<span class="delimiter">[</span>Char<span class="delimiter">]</span>, Option<span class="delimiter">[</span>List<span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">]</span> =
    <span title="(x: (scalaz.NonEmptyList[Char], Option[List[Char]]))Some[(scalaz.NonEmptyList[Char], Option[List[Char]])]">Some</span><span title="(_1: scalaz.NonEmptyList[Char], _2: Option[List[Char]])(scalaz.NonEmptyList[Char], Option[List[Char]])" class="delimiter">(</span><a href="#1180291" title="scalaz.http.request.Uri">uri</a>.<a href="#1140057" title="=&gt; scalaz.NonEmptyList[Char]">path</a>, <a href="#1180291" title="scalaz.http.request.Uri">uri</a>.<a href="#1140058" title="=&gt; Option[List[Char]]">queryString</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Constructs a URI with the given path and query string.
   */</span>
  <span class="keyword">def</span> <a title="(p: scalaz.NonEmptyList[Char], s: Option[List[Char]])java.lang.Object with scalaz.http.request.Uri" id="1142494">uri</a><span class="delimiter">(</span><a title="scalaz.NonEmptyList[Char]" id="1146789">p</a>: <a href="../../NonEmptyList.scala.html#17054" title="scalaz.NonEmptyList[Char]">NonEmptyList</a><span class="delimiter">[</span>Char<span class="delimiter">]</span>, <a title="Option[List[Char]]" id="1146790">s</a>: <span title="Option[List[Char]]">Option</span><span class="delimiter">[</span>List<span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#1146793" title="java.lang.Object with scalaz.http.request.Uri{}" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scalaz.http.request.Uri" id="1146793">Uri</a> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scalaz.NonEmptyList[Char]" id="1146795">path</a> = <a href="#1146789" title="scalaz.NonEmptyList[Char]">p</a>
    <span class="keyword">val</span> <a title="Option[List[Char]]" id="1146797">queryString</a> = <a href="#1146790" title="Option[List[Char]]">s</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>