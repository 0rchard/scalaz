<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>scalaz/http/Util.scala</title>
        <script type="text/javascript" src="../../jquery-all.js"></script>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scalaz
<span class="keyword">package</span> http

<span class="keyword">import</span> collection.immutable.<span class="delimiter">{</span>Map, HashMap<span class="delimiter">}</span>
<span class="keyword">import</span> <a href="../Scalaz.scala.html#18009" title="object scalaz.Scalaz">Scalaz</a>._
<span class="keyword">import</span> java.net.<span title="object java.net.URLDecoder">URLDecoder</span>.decode
<span class="keyword">import</span> io.Codec

<span class="comment">/**
 * Utility functions not specific to any particular context within HTTP.
 *
 * @author &lt;a href=&quot;mailto:code@tmorris.net&quot;&gt;Tony Morris&lt;/a&gt;
 */</span>
<span class="keyword">object</span> <a title="object scalaz.http.Util" id="25561">Util</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="comment">/**
   * Splits the given argument by ampersand (&lt;code&gt;&amp;&lt;/code&gt;) then each list again by the equals sign (&lt;code&gt;=&lt;/code&gt;).
   * e.g. &lt;code&gt;parameters(&quot;a=b&amp;c=d&amp;e=f&quot;) == [(&quot;a&quot;, &quot;b&quot;), (&quot;c&quot;, &quot;d&quot;), (&quot;e&quot;, &quot;f&quot;)]&lt;/code&gt; 
   */</span>
  <span class="keyword">def</span> <a title="(p: List[Char])List[(List[Char], List[Char])]" id="1106653">parameters</a><span class="delimiter">(</span><a title="List[Char]" id="1148922">p</a>: <span title="List[Char]">List</span><span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="List[(List[Char], List[Char])]">List</span><span class="delimiter">[</span><span class="delimiter">(</span>List<span class="delimiter">[</span>Char<span class="delimiter">]</span>, List<span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="List[List[Char]]" id="1148924">x</a> = <a href="../MA.scala.html#38809" title="(l: List[Char])scalaz.MA[List,Char]">p</a>.<a href="../MA.scala.html#63307" title="(p: (Char) =&gt; Boolean)(implicit r: scalaz.Foldable[List])List[List[Char]]">selectSplit</a><a href="../Foldable.scala.html#106964" title="=&gt; scalaz.Foldable[List]" class="delimiter">(</a><a href="#1151975" title="Char">_</a> <span title="(x: Char)Boolean">!=</span> <span title="Char(\'&amp;\')" class="char">'&amp;'</span><span class="delimiter">)</span>
    <span class="comment">// TODO Get !- back in scalaz and use that</span>
    <span class="comment">//    x map (_ !- (_ == '=') match {</span>
    <span class="comment">//      case (a, b) =&gt; {</span>
    <span class="comment">//        (a, decode(b.mkString).drop(1).toList)</span>
    <span class="comment">//      }</span>
    <span class="comment">//    })</span>

    <a href="#1148924" title="List[List[Char]]">x</a> <span title="(f: (List[Char]) =&gt; (List[Char], List[Char]))(implicit bf: scala.collection.generic.CanBuildFrom[List[List[Char]],(List[Char], List[Char]),List[(List[Char], List[Char])]])List[(List[Char], List[Char])]">map</span> <span class="delimiter">(</span><a title="List[Char]" id="1152032">chars</a> =&gt; <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="List[Char]" id="1152033">pre</a> = <a href="#1152032" title="List[Char]">chars</a> <span title="(p: (Char) =&gt; Boolean)List[Char]">takeWhile</span> <span class="delimiter">(</span><a href="#1152041" title="Char">_</a> <span title="(x: Char)Boolean">!=</span> <span title="Char(\'=\')" class="char">'='</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="List[Char]" id="1152034">post</a> = <a href="#1152032" title="List[Char]">chars</a> <span title="(p: (Char) =&gt; Boolean)List[Char]">dropWhile</span> <span class="delimiter">(</span><a href="#1152052" title="Char">_</a> <span title="(x: Char)Boolean">!=</span> <span title="Char(\'=\')" class="char">'='</span><span class="delimiter">)</span>
      <span title="(_1: List[Char], _2: List[Char])(List[Char], List[Char])" class="delimiter">(</span><a href="#1152033" title="List[Char]">pre</a>, <span title="(x$1: java.lang.String, x$2: java.lang.String)java.lang.String">decode</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="delimiter">(</span><a href="#1152034" title="List[Char]">post</a>.<span title="=&gt; String">mkString</span>, <span title="object scala.io.Codec">Codec</span>.<span title="=&gt; java.nio.charset.Charset">UTF8</span>.<span title="()java.lang.String">name</span><span class="delimiter">)</span>.<span title="(n: Int)String">drop</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<span title="=&gt; List[Char]">toList</span><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Encodes the given parameters by inserting an ampersand (&lt;code&gt;&amp;&lt;/code&gt;) between each pair and an equals sign
   * (&lt;code&gt;=&lt;/code&gt;) with each pair.
   */</span>
  <span class="keyword">def</span> <a title="(p: (List[Char], List[Char])*)String" id="1106654">encodeParameters</a><span class="delimiter">(</span><a title="(List[Char], List[Char])*" id="1152372">p</a>: <span title="(List[Char], List[Char])*" class="delimiter">(</span>List<span class="delimiter">[</span>Char<span class="delimiter">]</span>, List<span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">)</span>*<span class="delimiter">)</span>: <span title="String">String</span> =
    <a href="#1152372" title="(List[Char], List[Char])*">p</a>.<span title="=&gt; List[(List[Char], List[Char])]">toList</span> <a href="../ListW.scala.html#38597" title="(as: List[List[Char]])scalaz.ListW[List[Char]]">map</a> <a href="#1152399" title="List[Char]" class="delimiter">{</a><span class="keyword">case</span> <span title="List[Char]" class="delimiter">(</span><a title="List[Char]" id="1152402">k</a>, <a title="List[Char]" id="1152403">v</a><span class="delimiter">)</span> =&gt; <a href="#1152402" title="List[Char]">k</a> <a href="#1152405" title="(prefix: List[Char])List[Char]">:::</a> <span title="Char(\'=\')" class="char">'='</span> <a href="#1152406" title="(x: Char)List[Char]">::</a> <a href="#1152403" title="List[Char]">v</a><span class="delimiter">}</span> <a href="../ListW.scala.html#64876" title="(a: List[Char])List[List[Char]]">intersperse</a> <span title="(xs: Char*)List[Char]">List</span><span class="delimiter">(</span><span title="Char(\'&amp;\')" class="char">'&amp;'</span><span class="delimiter">)</span> <span title="(f: (List[Char]) =&gt; scala.collection.GenTraversableOnce[Char])(implicit bf: scala.collection.generic.CanBuildFrom[List[List[Char]],Char,List[Char]])List[Char]">flatMap</span> <span class="delimiter">(</span><a title="List[Char]" id="1152577">x</a> =&gt; <a href="#1152577" title="List[Char]">x</a><span class="delimiter">)</span> <span title="=&gt; String">mkString</span>

  <span class="comment">/**
   * Encodes the given parameters by inserting an ampersand (&lt;code&gt;&amp;&lt;/code&gt;) between each pair and an equals sign
   * (&lt;code&gt;=&lt;/code&gt;) with each pair.
   */</span>
  <span class="keyword">def</span> <a title="(p: (String, String)*)String" id="1106655">encode</a><span class="delimiter">(</span><a title="(String, String)*" id="1148355">p</a>: <span title="(String, String)*" class="delimiter">(</span>String, String<span class="delimiter">)</span>*<span class="delimiter">)</span>: <span title="String">String</span> = <a href="#1106654" title="(p: (List[Char], List[Char])*)String">encodeParameters</a><span class="delimiter">(</span><a href="#1148355" title="(String, String)*">p</a> <span title="(f: ((String, String)) =&gt; (List[Char], List[Char]))(implicit bf: scala.collection.generic.CanBuildFrom[Seq[(String, String)],(List[Char], List[Char]),Seq[(List[Char], List[Char])]])Seq[(List[Char], List[Char])]">map</span> <a href="#1152626" title="(List[Char], List[Char])" class="delimiter">{</a><span class="keyword">case</span> <span title="(List[Char], List[Char])" class="delimiter">(</span><a title="String" id="1152629">k</a>, <a title="String" id="1152630">v</a><span class="delimiter">)</span> =&gt; <span title="(_1: List[Char], _2: List[Char])(List[Char], List[Char])" class="delimiter">(</span><a href="#1152629" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">k</a>.<span title="=&gt; List[Char]">toList</span>, <a href="#1152630" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">v</a>.<span title="=&gt; List[Char]">toList</span><span class="delimiter">)</span><span class="delimiter">}</span>: _*<span class="delimiter">)</span>

  <span class="comment">/**
   * Returns a map of key/value pairs where only the first value for the given key is available.
   */</span>
  <span class="keyword">def</span> <a title="[K, C](p: scala.collection.immutable.Map[K,scalaz.NonEmptyList[C]])scala.collection.immutable.Map[K,C]" id="1106656">mapHeads</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="1106659">K</a>, <a title="&gt;: Nothing &lt;: Any" id="1106660">C</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scala.collection.immutable.Map[K,scalaz.NonEmptyList[C]]" id="1108808">p</a>: <span title="scala.collection.immutable.Map[K,scalaz.NonEmptyList[C]]">Map</span><span class="delimiter">[</span>K, NonEmptyList<span class="delimiter">[</span>C<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#1108808" title="scala.collection.immutable.Map[K,scalaz.NonEmptyList[C]]">p</a>.<span title="(f: (K, scalaz.NonEmptyList[C]) =&gt; C)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Map[K,scalaz.NonEmptyList[C]],(K, C),scala.collection.immutable.Map[K,C]])scala.collection.immutable.Map[K,C]">transform</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.Map.Coll,(K, C),scala.collection.immutable.Map[K,C]]" class="delimiter">(</span><span class="delimiter">(</span><a title="K" id="1108819">h</a>, <a title="scalaz.NonEmptyList[C]" id="1108820">v</a><a href="../NonEmptyList.scala.html#17054" title="scalaz.NonEmptyList[C]" class="delimiter">)</a> =&gt; <a href="#1108820" title="scalaz.NonEmptyList[C]">v</a>.<a href="../NonEmptyList.scala.html#46839" title="=&gt; C">head</a><span class="delimiter">)</span>

  <span class="keyword">trait</span> <a title="trait AsHashMap[T[_], SM[_]] extends java.lang.Object" id="1106661">AsHashMap</a><span class="delimiter">[</span><a title="[_]&gt;: Nothing &lt;: Any" id="1106662">T</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="1153101">_</a><span class="delimiter">]</span>, <a title="[_]&gt;: Nothing &lt;: Any" id="1106663">SM</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="1109588">_</a><span class="delimiter">]</span><span class="delimiter">]</span> <span title="java.lang.Object" class="delimiter">{</span>
    <span class="keyword">def</span> <a title="[K, V](kvs: T[(K, V)])(implicit f: scalaz.Foldable[T], implicit s: scalaz.Semigroup[SM[V]], implicit md: scalaz.Monad[SM])scala.collection.immutable.Map[K,SM[V]]" id="1109568">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="1109571">K</a>, <a title="&gt;: Nothing &lt;: Any" id="1109572">V</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="T[(K, V)]" id="1109584">kvs</a>: <a href="#1106662" title="T[(K, V)]">T</a><span class="delimiter">[</span><span class="delimiter">(</span>K, V<span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.Foldable[T]" id="1109585">f</a>: <a href="../Foldable.scala.html#13175" title="scalaz.Foldable[T]">Foldable</a><span class="delimiter">[</span>T<span class="delimiter">]</span>, <a title="scalaz.Semigroup[SM[V]]" id="1109586">s</a>: <a href="../Semigroup.scala.html#18335" title="scalaz.Semigroup[SM[V]]">Semigroup</a><span class="delimiter">[</span>SM<span class="delimiter">[</span>V<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="scalaz.Monad[SM]" id="1109587">md</a>: <a href="../Monad.scala.html#16682" title="scalaz.Monad[SM]">Monad</a><span class="delimiter">[</span>SM<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="scala.collection.immutable.Map[K,SM[V]]">Map</span><span class="delimiter">[</span>K, SM<span class="delimiter">[</span>V<span class="delimiter">]</span><span class="delimiter">]</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Indexes the given sequence of key/value pairs using an empty hash-map. The key/value pair type constructor must
   * support fold-left and the index is created in constant space.
   */</span>
  <span class="keyword">def</span> <a title="[T[_], SM[_]]=&gt; java.lang.Object with scalaz.http.Util.AsHashMap[T,SM]" id="1106664">asHashMap</a><span class="delimiter">[</span><a title="[_]&gt;: Nothing &lt;: Any" id="1106667">T</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="1109566">_</a><span class="delimiter">]</span>, <a title="[_]&gt;: Nothing &lt;: Any" id="1106668">SM</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="1109567">_</a><span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#1109565" title="java.lang.Object with scalaz.http.Util.AsHashMap[T,SM]" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scalaz.http.Util.AsHashMap[T,SM]" id="1109565">AsHashMap</a><span class="delimiter">[</span>T, SM<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="[K, V](kvs: T[(K, V)])(implicit f: scalaz.Foldable[T], implicit s: scalaz.Semigroup[SM[V]], implicit md: scalaz.Monad[SM])scala.collection.immutable.Map[K,SM[V]]" id="1109574">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="1109577">K</a>, <a title="&gt;: Nothing &lt;: Any" id="1109578">V</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="T[(K, V)]" id="1109579">kvs</a>: <a href="#1106667" title="T[(K, V)]">T</a><span class="delimiter">[</span><span class="delimiter">(</span>K, V<span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.Foldable[T]" id="1109580">f</a>: <a href="../Foldable.scala.html#13175" title="scalaz.Foldable[T]">Foldable</a><span class="delimiter">[</span>T<span class="delimiter">]</span>, <a title="scalaz.Semigroup[SM[V]]" id="1109581">s</a>: <a href="../Semigroup.scala.html#18335" title="scalaz.Semigroup[SM[V]]">Semigroup</a><span class="delimiter">[</span>SM<span class="delimiter">[</span>V<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="scalaz.Monad[SM]" id="1109582">md</a>: <a href="../Monad.scala.html#16682" title="scalaz.Monad[SM]">Monad</a><span class="delimiter">[</span>SM<span class="delimiter">]</span><span class="delimiter">)</span> =
      <a href="#1106669" title="(e: scala.collection.immutable.Map[K,SM[V]], kvs: T[(K, V)])(implicit f: scalaz.Foldable[T], implicit s: scalaz.Semigroup[SM[V]], implicit md: scalaz.Monad[SM])scala.collection.immutable.Map[K,SM[V]]">asMap</a><a href="#1109580" title="scalaz.Foldable[T]" class="delimiter">(</a><span title="scala.collection.immutable.HashMap[K,SM[V]]" class="keyword">new</span> <span title="scala.collection.immutable.HashMap[K,SM[V]]">HashMap</span><span class="delimiter">[</span>K, SM<span class="delimiter">[</span>V<span class="delimiter">]</span><span class="delimiter">]</span>, <a href="#1109579" title="T[(K, V)]">kvs</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Indexes the given sequence of key/value pairs using the given map. The key/value pair type constructor must support
   * fold-left and the index is created in constant space.
   */</span>
  <span class="keyword">def</span> <a title="[T[_], SM[_], K, V](e: scala.collection.immutable.Map[K,SM[V]], kvs: T[(K, V)])(implicit f: scalaz.Foldable[T], implicit s: scalaz.Semigroup[SM[V]], implicit md: scalaz.Monad[SM])scala.collection.immutable.Map[K,SM[V]]" id="1106669">asMap</a><span class="delimiter">[</span><a title="[_]&gt;: Nothing &lt;: Any" id="1106674">T</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="1109625">_</a><span class="delimiter">]</span>, <a title="[_]&gt;: Nothing &lt;: Any" id="1106675">SM</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="1109623">_</a><span class="delimiter">]</span>, <a title="&gt;: Nothing &lt;: Any" id="1106676">K</a>, <a title="&gt;: Nothing &lt;: Any" id="1106677">V</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scala.collection.immutable.Map[K,SM[V]]" id="1109618">e</a>: <span title="scala.collection.immutable.Map[K,SM[V]]">Map</span><span class="delimiter">[</span>K, SM<span class="delimiter">[</span>V<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="T[(K, V)]" id="1109619">kvs</a>: <a href="#1106674" title="T[(K, V)]">T</a><span class="delimiter">[</span><span class="delimiter">(</span>K, V<span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">)</span>
                   <span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.Foldable[T]" id="1109620">f</a>: <a href="../Foldable.scala.html#13175" title="scalaz.Foldable[T]">Foldable</a><span class="delimiter">[</span>T<span class="delimiter">]</span>, <a title="scalaz.Semigroup[SM[V]]" id="1109621">s</a>: <a href="../Semigroup.scala.html#18335" title="scalaz.Semigroup[SM[V]]">Semigroup</a><span class="delimiter">[</span>SM<span class="delimiter">[</span>V<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="scalaz.Monad[SM]" id="1109622">md</a>: <a href="../Monad.scala.html#16682" title="scalaz.Monad[SM]">Monad</a><span class="delimiter">[</span>SM<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="scala.collection.immutable.Map[K,SM[V]]">Map</span><span class="delimiter">[</span>K, SM<span class="delimiter">[</span>V<span class="delimiter">]</span><span class="delimiter">]</span> =
      <a href="#1109620" title="scalaz.Foldable[T]">f</a>.<a href="../Foldable.scala.html#81391" title="[A, B](t: T[A], z: B, f: (B, A) =&gt; B)B">foldLeft</a><span title="(t: T[(K, V)], z: scala.collection.immutable.Map[K,SM[V]], f: (scala.collection.immutable.Map[K,SM[V]], (K, V)) =&gt; scala.collection.immutable.Map[K,SM[V]])scala.collection.immutable.Map[K,SM[V]]" class="delimiter">[</span><span title="(K, V)" class="delimiter">(</span>K, V<span class="delimiter">)</span>, <span title="scala.collection.immutable.Map[K,SM[V]]">Map</span><span class="delimiter">[</span>K, SM<span class="delimiter">[</span>V<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><a href="#1109619" title="T[(K, V)]">kvs</a>, <a href="#1109618" title="scala.collection.immutable.Map[K,SM[V]]">e</a>, <span class="delimiter">(</span><a title="scala.collection.immutable.Map[K,SM[V]]" id="1153110">m</a>, <a title="(K, V)" id="1153111">kv</a><span title="(K, V)" class="delimiter">)</span> =&gt; <a href="#1153110" title="scala.collection.immutable.Map[K,SM[V]]">m</a> <span title="(kv: (K, SM[V]))scala.collection.immutable.Map[K,SM[V]]">+</span> <span class="delimiter">(</span><span title="(_1: K, _2: SM[V])(K, SM[V])" class="delimiter">(</span><a href="#1153111" title="(K, V)">kv</a>.<span title="=&gt; K">_1</span>, <a href="#1153110" title="scala.collection.immutable.Map[K,SM[V]]">m</a>.<span title="(key: K)Option[SM[V]]">get</span><span class="delimiter">(</span><a href="#1153111" title="(K, V)">kv</a>.<span title="=&gt; K">_1</span><span class="delimiter">)</span> <span title="SM[V]" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="SM[V]">None</span> =&gt; <a href="#1109622" title="scalaz.Monad[SM]">md</a>.<a href="../Pure.scala.html#38010" title="(a: =&gt; V)SM[V]">pure</a><span class="delimiter">(</span><a href="#1153111" title="(K, V)">kv</a>.<span title="=&gt; V">_2</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="SM[V]">Some</span><span class="delimiter">(</span><a title="SM[V]" id="1153180">vv</a><span class="delimiter">)</span> =&gt; <a href="#1109621" title="scalaz.Semigroup[SM[V]]">s</a>.<a href="../Semigroup.scala.html#40406" title="(s1: SM[V], s2: =&gt; SM[V])SM[V]">append</a><span class="delimiter">(</span><a href="#1109622" title="scalaz.Monad[SM]">md</a>.<a href="../Pure.scala.html#38010" title="(a: =&gt; V)SM[V]">pure</a><span class="delimiter">(</span><a href="#1153111" title="(K, V)">kv</a>.<span title="=&gt; V">_2</span><span class="delimiter">)</span>, <a href="#1153180" title="SM[V]">vv</a><span class="delimiter">)</span>
      <span class="delimiter">}</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">object</span> <a title="object scalaz.http.Util.Nel" id="1106678">Nel</a> <span title="ScalaObject" class="delimiter">{</span>
    <span class="comment">/**
     * Creates a list from a potential non-empty list.
     */</span>
    <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[A](as: Option[scalaz.NonEmptyList[A]])List[A]" id="1106683">OptionNonEmptyListList</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="1106685">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Option[scalaz.NonEmptyList[A]]" id="1107985">as</a>: <span title="Option[scalaz.NonEmptyList[A]]">Option</span><span class="delimiter">[</span>NonEmptyList<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>: <span title="List[A]">List</span><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#1107985" title="Option[scalaz.NonEmptyList[A]]">as</a> <span title="List[A]" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="scala.collection.immutable.Nil.type">None</span> =&gt; <span title="object Nil">Nil</span>
      <span class="keyword">case</span> <span title="List[A]">Some</span><span class="delimiter">(</span><a title="scalaz.NonEmptyList[A]" id="1153198">x</a><span class="delimiter">)</span> =&gt; <a href="#1153198" title="scalaz.NonEmptyList[A]">x</a>.<a href="../NonEmptyList.scala.html#46839" title="=&gt; A">head</a> <a href="#1153200" title="(x: A)List[A]">::</a> <a href="#1153198" title="scalaz.NonEmptyList[A]">x</a>.<a href="../NonEmptyList.scala.html#46840" title="=&gt; List[A]">tail</a>
    <span class="delimiter">}</span>

    <span class="comment">/**
     * Creates a list from the given non-empty list.
     */</span>
    <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[A](xs: scalaz.NonEmptyList[A])List[A]" id="1106686">NonEmptyListList</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="1106688">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.NonEmptyList[A]" id="1107981">xs</a>: <a href="../NonEmptyList.scala.html#17054" title="scalaz.NonEmptyList[A]">NonEmptyList</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="List[A]">List</span><span class="delimiter">[</span>A<span class="delimiter">]</span> = <a href="#1107981" title="scalaz.NonEmptyList[A]">xs</a>.<a href="../NonEmptyList.scala.html#46858" title="=&gt; List[A]">list</a>

    <span class="comment">/**
     * Creates a string from the given non-empty list.
     */</span>
    <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[A](xs: scalaz.NonEmptyList[Char])String" id="1106689">NonEmptyListString</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="1106691">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.NonEmptyList[Char]" id="1107979">xs</a>: <a href="../NonEmptyList.scala.html#17054" title="scalaz.NonEmptyList[Char]">NonEmptyList</a><span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#1107979" title="scalaz.NonEmptyList[Char]">xs</a>.<a href="../NonEmptyList.scala.html#46858" title="=&gt; List[Char]">list</a>.<span title="=&gt; String">mkString</span>
  <span class="delimiter">}</span>

  <span class="keyword">object</span> <a title="object scalaz.http.Util.Digits" id="1106680">Digits</a> <span title="ScalaObject" class="delimiter">{</span>
    <span class="comment">/**
     * Converts the given long value to a sequence of digits.
     */</span>
    <span class="keyword">def</span> <a title="[T[_]](n: Long)(implicit f: scalaz.Foldable[T], implicit p: scalaz.Pure[T], implicit e: scalaz.Empty[T], implicit plus: scalaz.Plus[T], implicit m: scalaz.Monoid[T[scalaz.Digit]])T[scalaz.Digit]" id="1153210">longDigits</a><span class="delimiter">[</span><a title="[_]&gt;: Nothing &lt;: Any" id="1153212">T</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="1153224">_</a><span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><a title="Long" id="1153218">n</a>: <span title="Long">Long</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.Foldable[T]" id="1153219">f</a>: <a href="../Foldable.scala.html#13175" title="scalaz.Foldable[T]">Foldable</a><span class="delimiter">[</span>T<span class="delimiter">]</span>, <a title="scalaz.Pure[T]" id="1153220">p</a>: <a href="../Pure.scala.html#17828" title="scalaz.Pure[T]">Pure</a><span class="delimiter">[</span>T<span class="delimiter">]</span>, <a title="scalaz.Empty[T]" id="1153221">e</a> : <a href="../Empty.scala.html#9722" title="scalaz.Empty[T]">Empty</a><span class="delimiter">[</span>T<span class="delimiter">]</span>, <a title="scalaz.Plus[T]" id="1153222">plus</a> : <a href="../Plus.scala.html#17591" title="scalaz.Plus[T]">Plus</a><span class="delimiter">[</span>T<span class="delimiter">]</span>, <a title="scalaz.Monoid[T[scalaz.Digit]]" id="1153223">m</a> : <a href="../Monoid.scala.html#16706" title="scalaz.Monoid[T[scalaz.Digit]]">Monoid</a><span class="delimiter">[</span>T<span class="delimiter">[</span>Digit<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#1153212" title="T[scalaz.Digit]">T</a><span class="delimiter">[</span>Digit<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="T[scalaz.Digit]" id="1153231">xxx</a> = <a href="../Identity.scala.html#38551" title="(x: =&gt; Long)scalaz.Identity[Long]">n</a>.<a href="../Identity.scala.html#47068" title="(f: (Long) =&gt; Option[(scalaz.Digit, Long)])(implicit p: scalaz.Pure[T], implicit m: scalaz.Monoid[T[scalaz.Digit]])T[scalaz.Digit]">unfold</a><a href="#1153220" title="scalaz.Pure[T]" class="delimiter">(</a><span class="delimiter">(</span>b: <span title="Long">Long</span><span class="delimiter">)</span> =&gt; <span title="Option[(scalaz.Digit, Long)]" class="keyword">if</span> <span class="delimiter">(</span><a href="#1153482" title="Long">b</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span title="object None">None</span> <span class="keyword">else</span> <span title="(x: (scalaz.Digit, Long))Some[(scalaz.Digit, Long)]">Some</span><span title="(_1: scalaz.Digit, _2: Long)(scalaz.Digit, Long)" class="delimiter">(</span><a href="#1153482" title="Long">b</a> <a href="../Digit.scala.html#38411" title="implicit scalaz.Digits.LongDigit : (n: Long)scalaz.Digit">%</a> <span title="Long(10L)" class="long">10L</span>: <a href="../Digit.scala.html#9554" title="scalaz.Digit">Digit</a>, <a href="#1153482" title="Long">b</a> <span title="(x: Long)Long">/</span> <span title="Long(10L)" class="long">10L</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="comment">// TODO this is just a reverse, which should get into scalaz4</span>
      <span title="T[scalaz.Digit]" class="keyword">if</span> <span class="delimiter">(</span><a href="#1153218" title="Long">n</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#1153220" title="scalaz.Pure[T]">p</a>.<a href="../Pure.scala.html#38010" title="(a: =&gt; scalaz.Digit)T[scalaz.Digit]">pure</a><span class="delimiter">(</span><a href="../Digit.scala.html#9555" title="object scalaz.Digit">Digit</a>.<a href="../Digit.scala.html#65057" title="object scalaz.Digit._0">_0</a><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#1153219" title="scalaz.Foldable[T]">f</a>.<a href="../Foldable.scala.html#81391" title="[A, B](t: T[A], z: B, f: (B, A) =&gt; B)B">foldLeft</a><span title="(t: T[scalaz.Digit], z: T[scalaz.Digit], f: (T[scalaz.Digit], scalaz.Digit) =&gt; T[scalaz.Digit])T[scalaz.Digit]" class="delimiter">[</span><a href="../Digit.scala.html#9554" title="scalaz.Digit">Digit</a>, <a href="#1153212" title="T[scalaz.Digit]">T</a><span class="delimiter">[</span>Digit<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><a href="#1153231" title="T[scalaz.Digit]">xxx</a>, <a href="#1153221" title="scalaz.Empty[T]">e</a>.<a href="../Empty.scala.html#119535" title="[A]=&gt; T[A]">empty</a><span title="T[scalaz.Digit]" class="delimiter">[</span><a href="../Digit.scala.html#9554" title="scalaz.Digit">Digit</a><span class="delimiter">]</span>, <span class="delimiter">(</span><a title="T[scalaz.Digit]" id="1153788">b</a>, <a title="scalaz.Digit" id="1153789">a</a><a href="../Digit.scala.html#9554" title="scalaz.Digit" class="delimiter">)</a> =&gt; <a href="#1153222" title="scalaz.Plus[T]">plus</a>.<a href="../Plus.scala.html#343478" title="(a1: T[scalaz.Digit], a2: =&gt; T[scalaz.Digit])T[scalaz.Digit]">plus</a><span class="delimiter">(</span><a href="#1153220" title="scalaz.Pure[T]">p</a>.<a href="../Pure.scala.html#38010" title="(a: =&gt; scalaz.Digit)T[scalaz.Digit]">pure</a><span class="delimiter">(</span><a href="#1153789" title="scalaz.Digit">a</a><span class="delimiter">)</span>, <a href="#1153788" title="T[scalaz.Digit]">b</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="comment">/**
     * Converts the given sequence of digits to a long value.
     */</span>
    <span class="keyword">def</span> <a title="[T[_]](ds: T[scalaz.Digit])(implicit f: scalaz.Foldable[T])Long" id="1153213">digitsLong</a><span class="delimiter">[</span><a title="[_]&gt;: Nothing &lt;: Any" id="1153215">T</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="1153807">_</a><span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><a title="T[scalaz.Digit]" id="1153803">ds</a>: <a href="#1153215" title="T[scalaz.Digit]">T</a><span class="delimiter">[</span>Digit<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.Foldable[T]" id="1153804">f</a>: <a href="../Foldable.scala.html#13175" title="scalaz.Foldable[T]">Foldable</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span> =
      <a href="#1153804" title="scalaz.Foldable[T]">f</a>.<a href="../Foldable.scala.html#81391" title="[A, B](t: T[A], z: B, f: (B, A) =&gt; B)B">foldLeft</a><span title="(t: T[scalaz.Digit], z: Long, f: (Long, scalaz.Digit) =&gt; Long)Long" class="delimiter">[</span><a href="../Digit.scala.html#9554" title="scalaz.Digit">Digit</a>, <span title="Long">Long</span><span class="delimiter">]</span><span class="delimiter">(</span><a href="#1153803" title="T[scalaz.Digit]">ds</a>, <span title="Long(0L)" class="long">0L</span>, <span class="delimiter">(</span><a title="Long" id="1153815">a</a>, <a title="scalaz.Digit" id="1153816">b</a><a href="../Digit.scala.html#9554" title="scalaz.Digit" class="delimiter">)</a> =&gt; <a href="#1153815" title="Long">a</a> <span title="(x: Long)Long">*</span> <span title="Long(10L)" class="long">10L</span> <span title="(x: Long)Long">+</span> <a href="../Digit.scala.html#38410" title="implicit scalaz.Digits.DigitLong : (d: scalaz.Digit)Long">b</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>