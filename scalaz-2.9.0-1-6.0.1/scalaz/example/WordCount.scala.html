<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>scalaz/example/WordCount.scala</title>
        <script type="text/javascript" src="../../jquery-all.js"></script>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scalaz.example

<span class="keyword">import</span> scalaz._
<span class="keyword">import</span> <a href="../Scalaz.scala.html#18009" title="object scalaz.Scalaz">Scalaz</a>._
<span class="keyword">import</span> collection.immutable.List

<span class="keyword">object</span> <a title="object scalaz.example.WordCount" id="23863">WordCount</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(args: Array[String])Unit" id="556232">main</a><span class="delimiter">(</span><a title="Array[String]" id="1088724">args</a>: <span title="Array[String]">Array</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="#556233" title="=&gt; Unit">wordCount</a>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Character/Line/Word Count from &quot;The Essense of the Iterator Pattern&quot;.
   *
   * http://www.comlab.ox.ac.uk/jeremy.gibbons/publications/iterator.pdf
   *
   * This is an experiment to discover which parts of this paper can be brought to Scalaz.
   */</span>
  <span class="keyword">def</span> <a title="=&gt; Unit" id="556233">wordCount</a> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="[A, B](f: (A) =&gt; B)(A) =&gt; scalaz.Const[B,Nothing]" id="1088727">liftC</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="1088730">A</a>, <a title="&gt;: Nothing &lt;: Any" id="1088731">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="(A) =&gt; B" id="1088740">f</a>: A =&gt; B<span class="delimiter">)</span> = <span class="delimiter">{</span>a: <a href="#1088730" title="A">A</a> =&gt; <a href="../Const.scala.html#46891" title="(value: B)scalaz.Const[B,Nothing]">Const</a><span class="delimiter">(</span><a href="#1088740" title="(v1: A)B">f</a><span class="delimiter">(</span><a href="#1088742" title="A">a</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">}</span>
    <span class="keyword">val</span> <a title="(Char) =&gt; scalaz.Const[Int,scalaz.Scalaz.⊥]" id="1088732">charCountBody</a>: <span class="delimiter">(</span>Char<span class="delimiter">)</span> =&gt; Const<span class="delimiter">[</span>Int, ⊥<span class="delimiter">]</span> = <a href="#1088727" title="(f: (Char) =&gt; Int)(Char) =&gt; scalaz.Const[Int,Nothing]">liftC</a><span class="delimiter">(</span><span title="object Function">Function</span>.<span title="(x: Int)(y: Char)Int">const</span><a href="#1088881" title="Char" class="delimiter">(</a><span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(text: List[Char])scalaz.Const[Int,scalaz.Scalaz.⊤]" id="1088733">charCount</a><span class="delimiter">(</span><a title="List[Char]" id="1088888">text</a>: <span title="List[Char]">List</span><span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../Const.scala.html#9395" title="scalaz.Const[Int,scalaz.Scalaz.⊤]">Const</a><span class="delimiter">[</span>Int, ⊤<span class="delimiter">]</span> = <a href="../MA.scala.html#38809" title="(l: List[Char])scalaz.MA[List,Char]">text</a>.<a href="../MA.scala.html#63234" title="[F[_], B](f: (Char) =&gt; F[B])(implicit a: scalaz.Applicative[F], implicit t: scalaz.Traverse[List])F[List[B]]">traverse</a><span title="(f: (Char) =&gt; scalaz.Const[Int,scalaz.Scalaz.⊤])(implicit a: scalaz.Applicative[[α]scalaz.Const[Int,α]], implicit t: scalaz.Traverse[List])scalaz.Const[Int,List[scalaz.Scalaz.⊤]]" class="delimiter">[</span><span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span>=Const<span class="delimiter">[</span>Int, α<span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#<a href="../Const.scala.html#9395" title="[α]scalaz.Const[Int,α]">λ</a>, <span title="scalaz.Scalaz.⊤">⊤</span><span class="delimiter">]</span><a href="../Applicative.scala.html#39985" title="(implicit evidence$24: scalaz.Monoid[Int])scalaz.Applicative[[α]scalaz.Const[Int,α]]" class="delimiter">(</a><a href="#1088732" title="(Char) =&gt; scalaz.Const[Int,scalaz.Scalaz.⊥]">charCountBody</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(p: Boolean)Int" id="1088734">test</a><span class="delimiter">(</span><a title="Boolean" id="1092367">p</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span>: <span title="Int">Int</span> = <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#1092367" title="Boolean">p</a><span class="delimiter">)</span> <span title="Int(1)" class="int">1</span> <span class="keyword">else</span> <span title="Int(0)" class="int">0</span>
    <span class="keyword">val</span> <a title="(Char) =&gt; scalaz.Const[Int,scalaz.Scalaz.⊥]" id="1088735">lineCountBody</a>: <span class="delimiter">(</span>Char<span class="delimiter">)</span> =&gt; Const<span class="delimiter">[</span>Int, ⊥<span class="delimiter">]</span> = <a href="#1088727" title="(f: (Char) =&gt; Int)(Char) =&gt; scalaz.Const[Int,Nothing]">liftC</a> <span class="delimiter">{</span>c: <span title="Char">Char</span> =&gt; <a href="#1088734" title="(p: Boolean)Int">test</a><span class="delimiter">(</span><a href="#1092372" title="Char">c</a> <span title="(x: Char)Boolean">==</span> <span title="Char(\'\\n\')" class="char">'\n'</span><span class="delimiter">)</span><span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="(text: List[Char])scalaz.Const[Int,scalaz.Scalaz.⊤]" id="1088736">lineCount</a><span class="delimiter">(</span><a title="List[Char]" id="1092381">text</a>: <span title="List[Char]">List</span><span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../Const.scala.html#9395" title="scalaz.Const[Int,scalaz.Scalaz.⊤]">Const</a><span class="delimiter">[</span>Int, ⊤<span class="delimiter">]</span> = <a href="../MA.scala.html#38809" title="(l: List[Char])scalaz.MA[List,Char]">text</a>.<a href="../MA.scala.html#63234" title="[F[_], B](f: (Char) =&gt; F[B])(implicit a: scalaz.Applicative[F], implicit t: scalaz.Traverse[List])F[List[B]]">traverse</a><span title="(f: (Char) =&gt; scalaz.Const[Int,scalaz.Scalaz.⊤])(implicit a: scalaz.Applicative[[α]scalaz.Const[Int,α]], implicit t: scalaz.Traverse[List])scalaz.Const[Int,List[scalaz.Scalaz.⊤]]" class="delimiter">[</span><span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span>=Const<span class="delimiter">[</span>Int, α<span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#<a href="../Const.scala.html#9395" title="[α]scalaz.Const[Int,α]">λ</a>, <span title="scalaz.Scalaz.⊤">⊤</span><span class="delimiter">]</span><a href="../Applicative.scala.html#39985" title="(implicit evidence$24: scalaz.Monoid[Int])scalaz.Applicative[[α]scalaz.Const[Int,α]]" class="delimiter">(</a><a href="#1088735" title="(Char) =&gt; scalaz.Const[Int,scalaz.Scalaz.⊥]">lineCountBody</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="List[Char]" id="1088737">text</a> = <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;the cat in the hat\n sat on the mat\n&quot;</span>.<span title="=&gt; List[Char]">toList</span>

    <a href="../Identity.scala.html#38551" title="(x: =&gt; (Int, Int))scalaz.Identity[(Int, Int)]" class="delimiter">(</a><a href="#1088733" title="(text: List[Char])scalaz.Const[Int,scalaz.Scalaz.⊤]">charCount</a><a href="../NewType.scala.html#47798" title="(n: scalaz.NewType[Int])Int" class="delimiter">(</a><a href="#1088737" title="List[Char]">text</a><span class="delimiter">)</span>: <span title="Int">Int</span>, <a href="#1088736" title="(text: List[Char])scalaz.Const[Int,scalaz.Scalaz.⊤]">lineCount</a><a href="../NewType.scala.html#47798" title="(n: scalaz.NewType[Int])Int" class="delimiter">(</a><a href="#1088737" title="List[Char]">text</a><span class="delimiter">)</span>: <span title="Int">Int</span><span class="delimiter">)</span> <a href="../Identity.scala.html#47038" title="(b: (Int, Int))(implicit e: scalaz.Equal[(Int, Int)], implicit s: scalaz.Show[(Int, Int)], implicit ev: &lt;:&lt;[(Int, Int),(Int, Int)])Unit">assert_===</a> <span class="delimiter">(</span><span title="Int(35)" class="int">35</span>, <span title="Int(2)" class="int">2</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="(Char) =&gt; (scalaz.Const[Int,scalaz.Scalaz.⊥], scalaz.Const[Int,scalaz.Scalaz.⊥])" id="1088738">wordCountLineCountBody</a> = <span class="delimiter">(</span>a: <span title="Char">Char</span><span class="delimiter">)</span> =&gt; <span title="(_1: scalaz.Const[Int,scalaz.Scalaz.⊥], _2: scalaz.Const[Int,scalaz.Scalaz.⊥])(scalaz.Const[Int,scalaz.Scalaz.⊥], scalaz.Const[Int,scalaz.Scalaz.⊥])" class="delimiter">(</span><a href="#1088732" title="(v1: Char)scalaz.Const[Int,scalaz.Scalaz.⊥]">charCountBody</a><span class="delimiter">(</span><a href="#1094288" title="Char">a</a><span class="delimiter">)</span>, <a href="#1088735" title="(v1: Char)scalaz.Const[Int,scalaz.Scalaz.⊥]">lineCountBody</a><span class="delimiter">(</span><a href="#1094288" title="Char">a</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(text: List[Char])(Int, Int)" id="1088739">wordCountLineCount</a><span class="delimiter">(</span><a title="List[Char]" id="1094300">text</a>: <span title="List[Char]">List</span><span class="delimiter">[</span>Char<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="(scalaz.Const[Int,List[scalaz.Scalaz.⊤]], scalaz.Const[Int,List[scalaz.Scalaz.⊤]])" id="1094301">result</a> = <a href="../MA.scala.html#38809" title="(l: List[Char])scalaz.MA[List,Char]">text</a>.<a href="../MA.scala.html#63234" title="[F[_], B](f: (Char) =&gt; F[B])(implicit a: scalaz.Applicative[F], implicit t: scalaz.Traverse[List])F[List[B]]">traverse</a><span title="(f: (Char) =&gt; (scalaz.Const[Int,scalaz.Scalaz.⊤], scalaz.Const[Int,scalaz.Scalaz.⊤]))(implicit a: scalaz.Applicative[[α](scalaz.Const[Int,α], scalaz.Const[Int,α])], implicit t: scalaz.Traverse[List])(scalaz.Const[Int,List[scalaz.Scalaz.⊤]], scalaz.Const[Int,List[scalaz.Scalaz.⊤]])" class="delimiter">[</span><span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span>=<span class="delimiter">(</span>Const<span class="delimiter">[</span>Int, α<span class="delimiter">]</span>, Const<span class="delimiter">[</span>Int, α<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">}</span><span class="delimiter">)</span>#<span title="[α](scalaz.Const[Int,α], scalaz.Const[Int,α])">λ</span>, <span title="scalaz.Scalaz.⊤">⊤</span><span class="delimiter">]</span><span class="delimiter">(</span><a href="#1088738" title="(Char) =&gt; (scalaz.Const[Int,scalaz.Scalaz.⊥], scalaz.Const[Int,scalaz.Scalaz.⊥])">wordCountLineCountBody</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="../Prod.scala.html#17619" title="object scalaz.Prod">Prod</a>.<a href="../Prod.scala.html#392022" title="[M[_], N[_]](implicit evidence$1: scalaz.Applicative[M], implicit evidence$2: scalaz.Applicative[N])scalaz.Applicative[[α](M[α], N[α])]">ProdApplicative</a><a href="../Applicative.scala.html#39985" title="(implicit evidence$1: scalaz.Applicative[[α]scalaz.Const[Int,α]], implicit evidence$2: scalaz.Applicative[[α]scalaz.Const[Int,α]])scalaz.Applicative[[α](scalaz.Const[Int,α], scalaz.Const[Int,α])]" class="delimiter">[</a><span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span>=Const<span class="delimiter">[</span>Int, α<span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#<a href="../Const.scala.html#9395" title="[α]scalaz.Const[Int,α]">λ</a>, <span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span>=Const<span class="delimiter">[</span>Int, α<span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#<a href="../Const.scala.html#9395" title="[α]scalaz.Const[Int,α]">λ</a><span class="delimiter">]</span>, <a href="../Traverse.scala.html#256392" title="(implicit e: scalaz.Traverse[List])scalaz.Traverse[List]">implicitly</a><span class="delimiter">)</span>
      <span title="(_1: Int, _2: Int)(Int, Int)" class="delimiter">(</span><a href="#1094301" title="(scalaz.Const[Int,List[scalaz.Scalaz.⊤]], scalaz.Const[Int,List[scalaz.Scalaz.⊤]])">result</a>.<span title="=&gt; scalaz.Const[Int,List[scalaz.Scalaz.⊤]]">_1</span>.<a href="../Const.scala.html#46908" title="=&gt; Int">value</a>, <a href="#1094301" title="(scalaz.Const[Int,List[scalaz.Scalaz.⊤]], scalaz.Const[Int,List[scalaz.Scalaz.⊤]])">result</a>.<span title="=&gt; scalaz.Const[Int,List[scalaz.Scalaz.⊤]]">_2</span>.<a href="../Const.scala.html#46908" title="=&gt; Int">value</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <a href="#1088739" title="(text: List[Char])(Int, Int)">wordCountLineCount</a><a href="../Identity.scala.html#38551" title="(x: =&gt; (Int, Int))scalaz.Identity[(Int, Int)]" class="delimiter">(</a><a href="#1088737" title="List[Char]">text</a><span class="delimiter">)</span> <a href="../Identity.scala.html#47038" title="(b: (Int, Int))(implicit e: scalaz.Equal[(Int, Int)], implicit s: scalaz.Show[(Int, Int)], implicit ev: &lt;:&lt;[(Int, Int),(Int, Int)])Unit">assert_===</a> <span class="delimiter">(</span><span title="Int(35)" class="int">35</span>, <span title="Int(2)" class="int">2</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>