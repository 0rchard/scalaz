<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>scalaz/Memo.scala</title>
        <script type="text/javascript" src="../jquery-all.js"></script>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scalaz

<span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait Memo[K, V] extends java.lang.Object" id="17625">Memo</a>[@specialized(Int) <a title="&gt;: Nothing &lt;: Any" id="21852">K</a>, @specialized(Int, Long, Double) <a title="&gt;: Nothing &lt;: Any" id="21853">V</a>] <a title="java.lang.Object" id="2746">{</a>
  <span class="keyword">def</span> <a title="(z: (K) =&gt; V)(K) =&gt; V" id="57432">apply</a>(<a title="(K) =&gt; V" id="182309">z</a>: K =&gt; V): K =&gt; V
}

<span class="keyword">trait</span> <a title="trait Memos extends java.lang.Object with ScalaObject" id="17691">Memos</a> <span title="ScalaObject">{</span>
  <span class="keyword">def</span> <a title="[K, V](f: ((K) =&gt; V) =&gt; (K) =&gt; V)scalaz.Memo[K,V]" id="34518">memo</a>[@specialized(Int) <a title="&gt;: Nothing &lt;: Any" id="34521">K</a>, @specialized(Int, Long, Double) <a title="&gt;: Nothing &lt;: Any" id="34522">V</a>](<a title="((K) =&gt; V) =&gt; (K) =&gt; V" id="224411">f</a>: (K =&gt; V) =&gt; K =&gt; V): <a href="#17625" title="scalaz.Memo[K,V]">Memo</a>[K, V] = <a href="#279663" title="java.lang.Object with scalaz.Memo[K,V]" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scalaz.Memo[K,V]" id="279663">Memo</a>[K, V] {
    <span class="keyword">def</span> <a title="(z: (K) =&gt; V)(K) =&gt; V" id="279667">apply</a>(<a title="(K) =&gt; V" id="279668">z</a>: K =&gt; V) = <a href="#224411" title="(v1: (K) =&gt; V)(K) =&gt; V">f</a>(<a href="#279668" title="(K) =&gt; V">z</a>)
  }

  <span class="keyword">def</span> <a title="[K, V]scalaz.Memo[K,V]" id="34523">nilMemo</a>[@specialized(Int) <a title="&gt;: Nothing &lt;: Any" id="34526">K</a>, @specialized(Int, Long, Double) <a title="&gt;: Nothing &lt;: Any" id="34527">V</a>]: <a href="#17625" title="scalaz.Memo[K,V]">Memo</a>[K, V] = <a href="#34518" title="[K, V](f: ((K) =&gt; V) =&gt; (K) =&gt; V)scalaz.Memo[K,V]">memo</a><span title="(f: ((K) =&gt; V) =&gt; (K) =&gt; V)scalaz.Memo[K,V]">[</span><a href="#34526" title="K">K</a>, <a href="#34527" title="V">V</a>](<a title="(K) =&gt; V" id="279702">z</a> =&gt; <a href="#279702" title="(K) =&gt; V">z</a>)

  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class ArrayMemo[V &gt;: Null] extends java.lang.Object with scalaz.Memo[Int,V] with ScalaObject" id="34528">ArrayMemo</a>[<a title="&gt;: Null &lt;: Any" id="34529">V</a> &gt;: Null: ClassManifest](<a title="Int" id="279713">n</a>: <span title="Int">Int</span>) <span class="keyword">extends</span> <a href="#17625" title="scalaz.Memo[Int,V]">Memo</a>[Int, V] {
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(f: (Int) =&gt; V)(Int) =&gt; V" id="279709">apply</a>(<a title="(Int) =&gt; V" id="279716">f</a>: (Int) =&gt; V) = {
      <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Array[V]" id="279721">a</a> = <a href="#279707" title="(len: Int)Array[V]" id="38288" class="keyword">new</a> Array[V](<a href="#279713" title="Int">n</a>)
      <a title="Int" id="279728">k</a> =&gt; {
        <span class="keyword">val</span> <a title="V" id="279729">t</a> = <a href="#279720" title="(i: Int)V">a</a>(<a href="#279728" title="Int">k</a>)
        <span title="V" class="keyword">if</span> (<a href="#279729" title="(x$1: Any)Boolean">t</a> == <span title="Null(null)" class="keyword">null</span>) {
          <span class="keyword">val</span> <a title="V" id="279732">v</a> = <a href="#279716" title="(v1: Int)V">f</a>(<a href="#279728" title="Int">k</a>)
          <a href="#279720" title="(i: Int,x: V)Unit">a</a>(<a href="#279728" title="Int">k</a>) = <a href="#279732" title="V">v</a>
          <a href="#279732" title="V">v</a>
        } <span class="keyword">else</span> <a href="#279729" title="V">t</a>
      }
    }
  }

  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class DoubleArrayMemo extends java.lang.Object with scalaz.Memo[Int,Double] with ScalaObject" id="34530">DoubleArrayMemo</a><span title="ScalaObject">(</span><a title="Int" id="279747">n</a>: <span title="Int">Int</span>, <a title="Double" id="279748">sentinel</a>: <span title="Double">Double</span>) <span class="keyword">extends</span> <a href="#17625" title="scalaz.Memo[Int,Double]">Memo</a>[Int, Double] {
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(f: (Int) =&gt; Double)(Int) =&gt; Double" id="279743">apply</a>(<a title="(Int) =&gt; Double" id="279750">f</a>: (Int) =&gt; Double) = {
      <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Array[Double]" id="279755">a</a> = {
        <span title="Array[Double]" class="keyword">if</span> (<a href="#279748" title="(x$1: Double)Boolean">sentinel</a> == <span title="Double(0.0)" class="double">0d</span>) {
          <span title="Array[Double]" class="keyword">new</span> <a title="Array[Double]" id="2028">Array</a>[Double](<a href="#279747" title="Int">n</a>)
        } <span class="keyword">else</span> {
          <a title="object Array" id="2029">Array</a>.<a title="(n: Int)(elem: =&gt; Double)(implicit evidence$9: scala.reflect.ClassManifest[Double])Array[Double]" id="28316">fill</a>(<a href="#279747" title="Int">n</a>)<a title="=&gt; scala.reflect.AnyValManifest[Double]" id="3030">(</a><a href="#279748" title="Double">sentinel</a>)
        }
      }
      <a title="Int" id="279802">k</a> =&gt; {
        <span class="keyword">val</span> <a title="Double" id="279803">t</a> = <a href="#279754" title="(i: Int)Double">a</a>(<a href="#279802" title="Int">k</a>)
        <span title="Double" class="keyword">if</span> (<a href="#279803" title="(x$1: Double)Boolean">t</a> == <a href="#279748" title="Double">sentinel</a>) {
          <span class="keyword">val</span> <a title="Double" id="279810">v</a> = <a href="#279750" title="(v1: Int)Double">f</a>(<a href="#279802" title="Int">k</a>)
          <a href="#279754" title="(i: Int,x: Double)Unit">a</a>(<a href="#279802" title="Int">k</a>) = <a href="#279810" title="Double">v</a>
          <a href="#279810" title="Double">v</a>
        } <span class="keyword">else</span> <a href="#279803" title="Double">t</a>
      }
    }
  }

  <span class="keyword">def</span> <a title="[V &gt;: Null](n: Int)(implicit evidence$2: ClassManifest[V])scalaz.Memo[Int,V]" id="279817">arrayMemo</a>[<a title="&gt;: Null &lt;: Any" id="34533">V</a> &gt;: Null : ClassManifest](<a title="Int" id="279816">n</a>: <span title="Int">Int</span>): <a href="#17625" title="scalaz.Memo[Int,V]">Memo</a>[Int, V] = <a href="#279817" title="Memos.this.ArrayMemo[V]" class="keyword">new</a> <a href="#34528" title="Memos.this.ArrayMemo[V]">ArrayMemo</a>(<a href="#279816" title="Int">n</a>)
  <span class="keyword">def</span> <a title="(n: Int,sentinel: Double)scalaz.Memo[Int,Double]" id="34534">doubleArrayMemo</a>(<a title="Int" id="279828">n</a>: <span title="Int">Int</span>, <a title="=&gt; Double" id="279829">sentinel</a>: <span title="Double">Double</span> = <span title="Double(0.0)" class="double">0d</span>): <a href="#17625" title="scalaz.Memo[Int,Double]">Memo</a>[Int, Double] = <span title="Memos.this.DoubleArrayMemo" class="keyword">new</span> <a href="#34530" title="Memos.this.DoubleArrayMemo">DoubleArrayMemo</a>(<a href="#279828" title="Int">n</a>, <a href="#279829" title="Double">sentinel</a>)

  <span class="keyword">def</span> <a title="[K, V]scalaz.Memo[K,V]" id="34535">mutableHashMapMemo</a>[<a title="&gt;: Nothing &lt;: Any" id="34538">K</a>, <a title="&gt;: Nothing &lt;: Any" id="34539">V</a>]: <a href="#17625" title="scalaz.Memo[K,V]">Memo</a>[K, V] = {
    <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[K,V]" id="279833">a</a> = <span title="scala.collection.mutable.HashMap[K,V]" class="keyword">new</span> <a title="scala.collection.mutable.HashMap[K,V]" id="32193">collection</a>.mutable.HashMap[K, V]

    <a href="#34518" title="[K, V](f: ((K) =&gt; V) =&gt; (K) =&gt; V)scalaz.Memo[K,V]">memo</a><span title="(f: ((K) =&gt; V) =&gt; (K) =&gt; V)scalaz.Memo[K,V]">[</span><a href="#34538" title="K">K</a>, <a href="#34539" title="V">V</a>](<a title="(K) =&gt; V" id="280038">f</a> =&gt;
      <a title="K" id="280040">k</a> =&gt;
        <a href="#279833" title="(key: K)Option[V]" id="279841">a</a> <span title="(default: =&gt; V)V">get</span> <a href="#280040" title="K">k</a> getOrElse {
          <span class="keyword">val</span> <a title="V" id="280048">v</a> = <a href="#280038" title="(v1: K)V">f</a>(<a href="#280040" title="K">k</a>)
          <a href="#279833" title="(key: K,value: V)Unit" id="279846">a</a> update (<a href="#280040" title="K">k</a>, <a href="#280048" title="V">v</a>)
          <a href="#280048" title="V">v</a>
        })
  }

  <span class="keyword">def</span> <a title="[K, V]scalaz.Memo[K,V]" id="34540">weakHashMapMemo</a>[<a title="&gt;: Nothing &lt;: Any" id="34543">K</a>, <a title="&gt;: Nothing &lt;: Any" id="34544">V</a>]: <a href="#17625" title="scalaz.Memo[K,V]">Memo</a>[K, V] = {
    <span class="keyword">val</span> <a title="java.util.WeakHashMap[K,V]" id="280061">a</a> = <a title="()java.util.WeakHashMap[K,V]" id="89489" class="keyword">new</a> <a title="java.util.WeakHashMap[K,V]" id="6745">java</a>.util.WeakHashMap[K, V]

    <a href="#34518" title="[K, V](f: ((K) =&gt; V) =&gt; (K) =&gt; V)scalaz.Memo[K,V]">memo</a><span title="(f: ((K) =&gt; V) =&gt; (K) =&gt; V)scalaz.Memo[K,V]">[</span><a href="#34543" title="K">K</a>, <a href="#34544" title="V">V</a>](<a title="(K) =&gt; V" id="280104">f</a> =&gt;
      <a title="K" id="280106">k</a> =&gt; {
        <span class="keyword">val</span> <a title="V" id="280107">v</a> = <a href="#280061" title="(x$1: Any)V" id="89505">a</a> get <a href="#280106" title="K">k</a>
        <span title="V" class="keyword">if</span> (<a href="#280107" title="(x$1: Any)Boolean">v</a> == <span title="Null(null)" class="keyword">null</span>) {
          <span class="keyword">val</span> <a title="V" id="280110">nv</a> = <a href="#280104" title="(v1: K)V">f</a>(<a href="#280106" title="K">k</a>)
          <a href="#280061" title="(x$1: K,x$2: V)V" id="89513">a</a> put (<a href="#280106" title="K">k</a>, <a href="#280110" title="V">nv</a>)
          <a href="#280110" title="V">nv</a>
        } <span class="keyword">else</span> {
          <a href="#280107" title="V">v</a>
        }
      })
  }

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="[K, V](m: Map[K,V])scalaz.Memo[K,V]" id="34545">immutableMapMemo</a>[<a title="&gt;: Nothing &lt;: Any" id="34548">K</a>, <a title="&gt;: Nothing &lt;: Any" id="34549">V</a>](<a title="Map[K,V]" id="280121">m</a>: <a title="Map[K,V]" id="29488">Map</a>[K, V]): <a href="#17625" title="scalaz.Memo[K,V]">Memo</a>[K, V] = {
    <span class="keyword">var</span> <a title="Map[K,V]" id="280124">a</a> = <a href="#280121" title="Map[K,V]">m</a>

    <a href="#34518" title="[K, V](f: ((K) =&gt; V) =&gt; (K) =&gt; V)scalaz.Memo[K,V]">memo</a><span title="(f: ((K) =&gt; V) =&gt; (K) =&gt; V)scalaz.Memo[K,V]">[</span><a href="#34548" title="K">K</a>, <a href="#34549" title="V">V</a>](<a title="(K) =&gt; V" id="280127">f</a> =&gt;
      <a title="K" id="280129">k</a> =&gt; {
        <a href="#280124" title="(key: K)Option[V]" id="57593">a</a> <span title="(default: =&gt; V)V">get</span> <a href="#280129" title="K">k</a> getOrElse {
          <span class="keyword">val</span> <a title="V" id="280136">v</a> = <a href="#280127" title="(v1: K)V">f</a>(<a href="#280129" title="K">k</a>)
          <a href="#280124" title="Map[K,V]">a</a> = <a href="#280124" title="(key: K,value: V)scala.collection.immutable.Map[K,V]" id="57553">a</a> updated (<a href="#280129" title="K">k</a>, <a href="#280136" title="V">v</a>)
          <a href="#280136" title="V">v</a>
        }
      })
  }

  <span class="keyword">import</span> collection.immutable.{HashMap, ListMap, TreeMap}

  <span class="keyword">def</span> <a title="[K, V]scalaz.Memo[K,V]" id="34551">immutableHashMapMemo</a>[<a title="&gt;: Nothing &lt;: Any" id="34554">K</a>, <a title="&gt;: Nothing &lt;: Any" id="34555">V</a>]: <a href="#17625" title="scalaz.Memo[K,V]">Memo</a>[K, V] = <a href="#34545" title="(m: Map[K,V])scalaz.Memo[K,V]">immutableMapMemo</a>(<span title="scala.collection.immutable.HashMap[K,V]" class="keyword">new</span> <a title="scala.collection.immutable.HashMap[K,V]" id="29923">HashMap</a>[K, V])

  <span class="keyword">def</span> <a title="[K, V]scalaz.Memo[K,V]" id="34556">immutableListMapMemo</a>[<a title="&gt;: Nothing &lt;: Any" id="34559">K</a>, <a title="&gt;: Nothing &lt;: Any" id="34560">V</a>]: <a href="#17625" title="scalaz.Memo[K,V]">Memo</a>[K, V] = <a href="#34545" title="(m: Map[K,V])scalaz.Memo[K,V]">immutableMapMemo</a>(<span title="scala.collection.immutable.ListMap[K,V]" class="keyword">new</span> <a title="scala.collection.immutable.ListMap[K,V]" id="29932">ListMap</a>[K, V])

  <span class="keyword">def</span> <a title="[K, V](implicit evidence$3: Ordering[K])scalaz.Memo[K,V]" id="280494">immutableTreeMapMemo</a>[<a title="&gt;: Nothing &lt;: Any" id="34564">K</a>: scala.Ordering, <a title="&gt;: Nothing &lt;: Any" id="34565">V</a>]: <a href="#17625" title="scalaz.Memo[K,V]">Memo</a>[K, V] = <a href="#34545" title="(m: Map[K,V])scalaz.Memo[K,V]">immutableMapMemo</a>(<a href="#280494" title="()(implicit ordering: Ordering[K])scala.collection.immutable.TreeMap[K,V]" id="280515" class="keyword">new</a> <a title="scala.collection.immutable.TreeMap[K,V]" id="29503">TreeMap</a>[K, V])
}

        </pre>
    </body>
</html>